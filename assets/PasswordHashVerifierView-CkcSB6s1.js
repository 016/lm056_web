import{d as X,u as Y,r as c,c as I,i as Z,k as N,a as u,b as e,t as l,e as r,g as _,w as y,v as L,j as F,n as V,s as ee,x as se,T as te,m as ae,F as oe,h as re,f as le,o as p,p as ie,_ as ne}from"./index-BRAbxy0F.js";const ce={class:"main-content flex-grow-1"},de={class:"page-header-row"},ue={class:"page-header-left"},pe={class:"page-title"},he={class:"page-description"},me={class:"breadcrumb-custom"},ge={"aria-label":"breadcrumb"},ve={class:"breadcrumb mb-0"},fe={class:"breadcrumb-item"},be={href:"#"},_e={class:"breadcrumb-item"},we={href:"#"},ye={class:"breadcrumb-item active","aria-current":"page"},xe={class:"row"},Ve={class:"col-lg-5 col-md-12 mb-3 mb-lg-0"},He={class:"card tool-card"},ke={class:"card-header"},Te={class:"card-body"},Ce={class:"param-group"},je={class:"param-label"},Me=["placeholder"],Se={class:"param-group d-flex align-items-center justify-content-between"},$e={class:"param-label mb-0"},Ae=["title"],Ie={class:"cost-control d-flex align-items-center gap-3",style:{width:"200px"}},Le={class:"badge bg-accent rounded-pill",style:{"min-width":"3em"}},Oe={class:"param-group mb-0"},Pe={class:"param-label"},Ee=["placeholder"],Ue={class:"card-footer"},We={class:"control-row"},Ge={class:"auto-match-control"},Ne={class:"auto-match-label"},Fe={class:"switch"},Re=["disabled"],qe={key:0,class:"bi bi-cpu"},Be={key:1,class:"spinner-border spinner-border-sm"},De={class:"control-row mt-2"},ze={class:"auto-match-control"},Ke={class:"auto-match-label"},Je={class:"switch"},Qe=["disabled"],Xe={key:0,class:"bi bi-search"},Ye={key:1,class:"spinner-border spinner-border-sm"},Ze={class:"d-flex align-items-center"},es=["innerHTML"],ss={class:"col-lg-7 col-md-12"},ts={class:"card tool-card"},as={class:"card-header d-flex justify-content-between align-items-center card-header-with-controls"},os={key:0,class:"text-success ms-2 fw-bold"},rs={key:1,class:"text-secondary ms-2"},ls={class:"encode-selector"},is={class:"encode-label"},ns=["data-bs-title"],cs={value:"original"},ds={value:"base64"},us={value:"base64url"},ps={value:"hex"},hs={value:"base2"},ms={class:"card-body"},gs={key:0,class:"table-responsive"},vs={class:"table hash-results-table table-hover"},fs={style:{width:"120px"}},bs={style:{width:"100px"}},_s={class:"algorithm-name"},ws={class:"d-flex align-items-center gap-2"},ys=["value"],xs=["onClick"],Vs={class:"match-status"},Hs={key:0},ks={key:1,class:"empty-results"},Ts={class:"text-muted mt-1"},Cs={class:"card tool-card no-footer mt-3"},js={class:"card-header"},Ms={class:"card-body"},Ss={class:"notice-box"},$s=X({__name:"PasswordHashVerifierView",setup(As){const{t}=Y(),i=c(""),m=c(""),x=c(!1),h=c(!1),H=c(10),k=c("original"),g=c([]),d=c(null),T=c(null),C=c(!1),b=c(!1),w=c(!1),S=c(null);let $=null;const v=c({bcrypt:!1,scrypt:!1,argon2:!1}),R=I(()=>b.value?"calculating":!i.value&&!m.value||!i.value||!m.value||!h.value&&!w.value?"empty":d.value?"success":"no-match"),q=I(()=>b.value?"spinner-border spinner-border-sm":!i.value||!m.value||!h.value&&!w.value?"bi bi-info-circle text-secondary":d.value?"bi bi-check-circle-fill text-success":"bi bi-x-circle-fill text-danger"),B=I(()=>b.value?t("pages.passwordHashVerifier.status.matching"):!i.value&&!m.value?t("pages.passwordHashVerifier.status.waiting"):i.value?m.value?!h.value&&!w.value?t("pages.passwordHashVerifier.status.waitingManual"):d.value?t("pages.passwordHashVerifier.status.success",{algorithm:d.value}):t("pages.passwordHashVerifier.status.notFound"):t("pages.passwordHashVerifier.status.inputHash"):t("pages.passwordHashVerifier.status.inputPlaintext")),j=a=>new Promise((s,o)=>{if(document.querySelector(`script[src="${a}"]`)){s();return}const n=document.createElement("script");n.src=a,n.onload=()=>s(),n.onerror=()=>o(new Error(`Failed to load script: ${a}`)),document.head.appendChild(n)});Z(async()=>{try{await Promise.all([j("https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js").then(()=>v.value.bcrypt=!0),j("https://unpkg.com/scrypt-js@3.0.1/scrypt.js").then(()=>v.value.scrypt=!0),j("https://cdnjs.cloudflare.com/ajax/libs/argon2-browser/1.18.0/argon2-bundled.min.js").then(()=>v.value.argon2=!0),j("https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js")])}catch(a){console.error("Failed to load crypto libraries",a)}});const O=a=>{a.style.height="auto",a.style.height=a.scrollHeight+"px"},D=()=>{x.value&&P()},P=()=>{h.value||(w.value=!1,d.value=null),x.value&&($&&clearTimeout($),$=setTimeout(()=>{W()},500))},z=()=>{h.value||(w.value=!1,d.value=null),h.value&&i.value&&g.value.length>0&&M()},E=a=>{if(!a||a.startsWith("Error")||a.startsWith("Library")||k.value==="original")return a;try{const o=new TextEncoder().encode(a);switch(k.value){case"base64":return U(o);case"base64url":return U(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");case"hex":return K(o);case"base2":return Array.from(o).map(n=>n.toString(2).padStart(8,"0")).join(" ");default:return a}}catch{return a}},U=a=>{let s="";const o=new Uint8Array(a),n=o.byteLength;for(let f=0;f<n;f++)s+=String.fromCharCode(o[f]);return window.btoa(s)},K=a=>Array.from(a).map(s=>s.toString(16).padStart(2,"0")).join(""),W=async()=>{if(!i.value){g.value=[];return}C.value=!0;const a=[];try{if(v.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt){const s=await new Promise(o=>{window.dcodeIO.bcrypt.hash(i.value,H.value,(n,f)=>{o(f)})});a.push({algorithm:"bcrypt",value:s,raw:s,matched:!1})}if(v.value.scrypt&&window.scrypt){const s=new TextEncoder().encode(i.value),o=new TextEncoder().encode("salt"),Q=await window.scrypt.scrypt(s,o,16384,8,1,64),G=`$s0$e0801$${window.btoa("salt")}$${window.btoa(String.fromCharCode.apply(null,Array.from(Q)))}`;a.push({algorithm:"scrypt",value:G,raw:G,matched:!1})}if(v.value.argon2&&window.argon2)try{const s=await window.argon2.hash({pass:i.value,salt:"somesalt",type:window.argon2.Argon2id,time:2,mem:65536,hashLen:32});a.push({algorithm:"Argon2",value:s.encoded,raw:s.encoded,matched:!1})}catch(s){console.error("Argon2 error",s)}}catch(s){console.error("Generation error",s)}g.value=a,C.value=!1,S.value=new Date().toLocaleTimeString(),h.value&&m.value&&M()},M=async()=>{if(!i.value||!m.value){d.value=null;return}b.value=!0,w.value=!0,d.value=null,g.value.forEach(s=>s.matched=!1);const a=m.value.trim();try{if((a.startsWith("$2")||a.startsWith("$2a")||a.startsWith("$2y")||a.startsWith("$2b"))&&v.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt&&await new Promise(o=>{window.dcodeIO.bcrypt.compare(i.value,a,(n,f)=>{o(f)})})&&(d.value="bcrypt",A("bcrypt")),!d.value&&a.startsWith("$argon2")&&v.value.argon2&&window.argon2)try{await window.argon2.verify({pass:i.value,encoded:a}),d.value="Argon2",A("Argon2")}catch{}if(!d.value){const s=g.value.find(o=>o.algorithm==="scrypt");s&&s.raw===a&&(d.value="scrypt",A("scrypt"))}}catch(s){console.error("Match error",s)}b.value=!1},A=a=>{const s=g.value.find(o=>o.algorithm===a);s&&(s.matched=!0)},J=async(a,s)=>{try{await navigator.clipboard.writeText(a),T.value=s,setTimeout(()=>{T.value=null},2e3)}catch(o){console.error("Copy failed",o)}};return N(h,a=>{a&&g.value.length>0&&M()}),N(g,async()=>{await ie(),document.querySelectorAll(".hash-value").forEach(s=>O(s))},{deep:!0}),(a,s)=>(p(),u("main",ce,[e("div",de,[e("div",ue,[e("h1",pe,l(r(t)("pages.passwordHashVerifier.title")),1),e("p",he,l(r(t)("pages.passwordHashVerifier.description")),1)]),e("div",me,[e("nav",ge,[e("ol",ve,[e("li",fe,[e("a",be,l(r(t)("breadcrumb.home")),1)]),e("li",_e,[e("a",we,l(r(t)("breadcrumb.tools")),1)]),e("li",ye,l(r(t)("pages.passwordHashVerifier.title_short")),1)])])])]),e("div",xe,[e("div",Ve,[e("div",He,[e("div",ke,[s[7]||(s[7]=e("i",{class:"bi bi-sliders"},null,-1)),_(" "+l(r(t)("pages.passwordHashVerifier.settings.title")),1)]),e("div",Te,[e("div",Ce,[e("label",je,l(r(t)("pages.passwordHashVerifier.settings.plaintext"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[0]||(s[0]=o=>i.value=o),onInput:P,placeholder:r(t)("pages.passwordHashVerifier.settings.plaintextPlaceholder")},null,40,Me),[[L,i.value]])]),e("div",Se,[e("div",$e,[_(l(r(t)("pages.passwordHashVerifier.settings.costLabel"))+" ",1),e("i",{class:"bi bi-question-circle-fill text-muted","data-bs-toggle":"tooltip",title:r(t)("pages.passwordHashVerifier.settings.costTooltip")},null,8,Ae)]),e("div",Ie,[y(e("input",{type:"range",class:"form-range",min:"4",max:"31",step:"1","onUpdate:modelValue":s[1]||(s[1]=o=>H.value=o),onInput:D},null,544),[[L,H.value,void 0,{number:!0}]]),e("span",Le,l(H.value),1)])]),e("div",Oe,[e("label",Pe,l(r(t)("pages.passwordHashVerifier.settings.hashToMatch"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[2]||(s[2]=o=>m.value=o),onInput:z,placeholder:r(t)("pages.passwordHashVerifier.settings.hashPlaceholder")},null,40,Ee),[[L,m.value]])])]),e("div",Ue,[e("div",We,[e("div",Ge,[e("span",Ne,l(r(t)("pages.passwordHashVerifier.settings.autoGenerate")),1),e("label",Fe,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=o=>x.value=o)},null,512),[[F,x.value]]),s[8]||(s[8]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"manual-match-btn",disabled:x.value||C.value,onClick:W},[C.value?(p(),u("span",Be)):(p(),u("i",qe)),_(" "+l(r(t)("pages.passwordHashVerifier.settings.manualGenerate")),1)],8,Re)]),e("div",De,[e("div",ze,[e("span",Ke,l(r(t)("pages.passwordHashVerifier.settings.autoMatch")),1),e("label",Je,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>h.value=o)},null,512),[[F,h.value]]),s[9]||(s[9]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"manual-match-btn",disabled:h.value||b.value,onClick:M},[b.value?(p(),u("span",Ye)):(p(),u("i",Xe)),_(" "+l(r(t)("pages.passwordHashVerifier.settings.manualMatch")),1)],8,Qe)]),s[10]||(s[10]=e("div",{class:"board"},null,-1)),e("div",{class:V(["match-result-box",R.value])},[e("div",Ze,[e("i",{class:V(["match-icon",q.value])},null,2),e("p",{class:"match-text",innerHTML:B.value},null,8,es)])],2)])])]),e("div",ss,[e("div",ts,[e("div",as,[e("div",null,[s[12]||(s[12]=e("i",{class:"bi bi-list-check"},null,-1)),_(" "+l(r(t)("pages.passwordHashVerifier.results.title"))+" ",1),ee(te,{name:"fade",mode:"out-in"},{default:se(()=>[S.value?(p(),u("small",os,[s[11]||(s[11]=e("i",{class:"bi bi-check-circle-fill me-1"},null,-1)),_(" "+l(r(t)("pages.passwordHashVerifier.results.generatedSuccess",{time:S.value})),1)])):(p(),u("small",rs,l(r(t)("pages.passwordHashVerifier.results.notGenerated")),1))]),_:1})]),e("div",ls,[e("label",is,l(r(t)("pages.passwordHashVerifier.results.encoding"))+":",1),e("i",{class:"bi bi-question-circle-fill","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":r(t)("pages.passwordHashVerifier.results.encodingTooltip")},null,8,ns),y(e("select",{class:"form-select form-select-sm encode-select","onUpdate:modelValue":s[5]||(s[5]=o=>k.value=o)},[e("option",cs,l(r(t)("pages.passwordHashVerifier.results.encodingOptions.original")),1),e("option",ds,l(r(t)("pages.passwordHashVerifier.results.encodingOptions.base64")),1),e("option",us,l(r(t)("pages.passwordHashVerifier.results.encodingOptions.base64url")),1),e("option",ps,l(r(t)("pages.passwordHashVerifier.results.encodingOptions.hex")),1),e("option",hs,l(r(t)("pages.passwordHashVerifier.results.encodingOptions.base2")),1)],512),[[ae,k.value]])])]),e("div",ms,[g.value.length>0?(p(),u("div",gs,[e("table",vs,[e("thead",null,[e("tr",null,[e("th",fs,l(r(t)("pages.passwordHashVerifier.results.algorithm")),1),e("th",null,l(r(t)("pages.passwordHashVerifier.results.hash")),1),e("th",bs,l(r(t)("pages.passwordHashVerifier.results.status")),1)])]),e("tbody",null,[(p(!0),u(oe,null,re(g.value,o=>(p(),u("tr",{key:o.algorithm},[e("td",_s,l(o.algorithm),1),e("td",null,[e("div",ws,[e("textarea",{class:"hash-value",value:E(o.value),onInput:s[6]||(s[6]=n=>O(n.target)),rows:"1",spellcheck:"false"},null,40,ys),e("button",{class:V(["copy-hash-btn",{copied:T.value===o.algorithm}]),onClick:n=>J(E(o.value),o.algorithm)},[e("i",{class:V(T.value===o.algorithm?"bi bi-check-lg":"bi bi-clipboard")},null,2)],10,xs)])]),e("td",null,[e("div",Vs,[e("span",{class:V(["match-badge",{matched:o.matched}])},[o.matched?(p(),u("span",Hs,l(r(t)("pages.passwordHashVerifier.results.matched")),1)):le("",!0)],2)])])]))),128))])])])):(p(),u("div",ks,[s[13]||(s[13]=e("i",{class:"bi bi-fingerprint"},null,-1)),e("p",null,l(r(t)("pages.passwordHashVerifier.results.empty")),1),e("p",Ts,l(r(t)("pages.passwordHashVerifier.results.emptyHint")),1)]))])])])]),e("div",Cs,[e("div",js,[s[14]||(s[14]=e("i",{class:"bi bi-info-circle"},null,-1)),_(" "+l(r(t)("pages.passwordHashVerifier.notice.title")),1)]),e("div",Ms,[e("div",Ss,[e("ul",null,[e("li",null,l(r(t)("pages.passwordHashVerifier.notice.item1")),1),e("li",null,l(r(t)("pages.passwordHashVerifier.notice.item2")),1),e("li",null,l(r(t)("pages.passwordHashVerifier.notice.item3")),1),e("li",null,l(r(t)("pages.passwordHashVerifier.notice.item4")),1)])])])])]))}}),Ps=ne($s,[["__scopeId","data-v-deac2f1a"]]);export{Ps as default};
