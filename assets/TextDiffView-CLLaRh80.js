import{d as fe,u as de,r as _,k as ve,b as B,e as a,t as g,f as m,n as E,h as A,g as he,w as Q,v as X,F as me,i as ge,B as pe,q as K,o as R,_ as xe}from"./index-BDVR_Oui.js";class _e{diff(e,t,l={}){let s;typeof l=="function"?(s=l,l={}):"callback"in l&&(s=l.callback);const o=this.castInput(e,l),n=this.castInput(t,l),c=this.removeEmpty(this.tokenize(o,l)),r=this.removeEmpty(this.tokenize(n,l));return this.diffWithOptionsObj(c,r,l,s)}diffWithOptionsObj(e,t,l,s){var o;const n=v=>{if(v=this.postProcess(v,l),s){setTimeout(function(){s(v)},0);return}else return v},c=t.length,r=e.length;let x=1,d=c+r;l.maxEditLength!=null&&(d=Math.min(d,l.maxEditLength));const T=(o=l.timeout)!==null&&o!==void 0?o:1/0,P=Date.now()+T,b=[{oldPos:-1,lastComponent:void 0}];let C=this.extractCommon(b[0],t,e,0,l);if(b[0].oldPos+1>=r&&C+1>=c)return n(this.buildValues(b[0].lastComponent,t,e));let y=-1/0,D=1/0;const F=()=>{for(let v=Math.max(y,-x);v<=Math.min(D,x);v+=2){let k;const w=b[v-1],H=b[v+1];w&&(b[v-1]=void 0);let j=!1;if(H){const O=H.oldPos-v;j=H&&0<=O&&O<c}const S=w&&w.oldPos+1<r;if(!j&&!S){b[v]=void 0;continue}if(!S||j&&w.oldPos<H.oldPos?k=this.addToPath(H,!0,!1,0,l):k=this.addToPath(w,!1,!0,1,l),C=this.extractCommon(k,t,e,v,l),k.oldPos+1>=r&&C+1>=c)return n(this.buildValues(k.lastComponent,t,e))||!0;b[v]=k,k.oldPos+1>=r&&(D=Math.min(D,v-1)),C+1>=c&&(y=Math.max(y,v+1))}x++};if(s)(function v(){setTimeout(function(){if(x>d||Date.now()>P)return s(void 0);F()||v()},0)})();else for(;x<=d&&Date.now()<=P;){const v=F();if(v)return v}}addToPath(e,t,l,s,o){const n=e.lastComponent;return n&&!o.oneChangePerToken&&n.added===t&&n.removed===l?{oldPos:e.oldPos+s,lastComponent:{count:n.count+1,added:t,removed:l,previousComponent:n.previousComponent}}:{oldPos:e.oldPos+s,lastComponent:{count:1,added:t,removed:l,previousComponent:n}}}extractCommon(e,t,l,s,o){const n=t.length,c=l.length;let r=e.oldPos,x=r-s,d=0;for(;x+1<n&&r+1<c&&this.equals(l[r+1],t[x+1],o);)x++,r++,d++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return d&&!o.oneChangePerToken&&(e.lastComponent={count:d,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=r,x}equals(e,t,l){return l.comparator?l.comparator(e,t):e===t||!!l.ignoreCase&&e.toLowerCase()===t.toLowerCase()}removeEmpty(e){const t=[];for(let l=0;l<e.length;l++)e[l]&&t.push(e[l]);return t}castInput(e,t){return e}tokenize(e,t){return Array.from(e)}join(e){return e.join("")}postProcess(e,t){return e}get useLongestToken(){return!1}buildValues(e,t,l){const s=[];let o;for(;e;)s.push(e),o=e.previousComponent,delete e.previousComponent,e=o;s.reverse();const n=s.length;let c=0,r=0,x=0;for(;c<n;c++){const d=s[c];if(d.removed)d.value=this.join(l.slice(x,x+d.count)),x+=d.count;else{if(!d.added&&this.useLongestToken){let T=t.slice(r,r+d.count);T=T.map(function(P,b){const C=l[x+b];return C.length>P.length?C:P}),d.value=this.join(T)}else d.value=this.join(t.slice(r,r+d.count));r+=d.count,d.added||(x+=d.count)}}return s}}function ee(i,e){let t;for(t=0;t<i.length&&t<e.length;t++)if(i[t]!=e[t])return i.slice(0,t);return i.slice(0,t)}function te(i,e){let t;if(!i||!e||i[i.length-1]!=e[e.length-1])return"";for(t=0;t<i.length&&t<e.length;t++)if(i[i.length-(t+1)]!=e[e.length-(t+1)])return i.slice(-t);return i.slice(-t)}function U(i,e,t){if(i.slice(0,e.length)!=e)throw Error(`string ${JSON.stringify(i)} doesn't start with prefix ${JSON.stringify(e)}; this is a bug`);return t+i.slice(e.length)}function Z(i,e,t){if(!e)return i+t;if(i.slice(-e.length)!=e)throw Error(`string ${JSON.stringify(i)} doesn't end with suffix ${JSON.stringify(e)}; this is a bug`);return i.slice(0,-e.length)+t}function I(i,e){return U(i,e,"")}function J(i,e){return Z(i,e,"")}function le(i,e){return e.slice(0,be(i,e))}function be(i,e){let t=0;i.length>e.length&&(t=i.length-e.length);let l=e.length;i.length<e.length&&(l=i.length);const s=Array(l);let o=0;s[0]=0;for(let n=1;n<l;n++){for(e[n]==e[o]?s[n]=s[o]:s[n]=o;o>0&&e[n]!=e[o];)o=s[o];e[n]==e[o]&&o++}o=0;for(let n=t;n<i.length;n++){for(;o>0&&i[n]!=e[o];)o=s[o];i[n]==e[o]&&o++}return o}function N(i){let e;for(e=i.length-1;e>=0&&i[e].match(/\s/);e--);return i.substring(e+1)}function $(i){const e=i.match(/^\s*/);return e?e[0]:""}const se="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Ce=new RegExp(`[${se}]+|\\s+|[^${se}]`,"ug");class we extends _e{equals(e,t,l){return l.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e.trim()===t.trim()}tokenize(e,t={}){let l;if(t.intlSegmenter){const n=t.intlSegmenter;if(n.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');l=Array.from(n.segment(e),c=>c.segment)}else l=e.match(Ce)||[];const s=[];let o=null;return l.forEach(n=>{/\s/.test(n)?o==null?s.push(n):s.push(s.pop()+n):o!=null&&/\s/.test(o)?s[s.length-1]==o?s.push(s.pop()+n):s.push(o+n):s.push(n),o=n}),s}join(e){return e.map((t,l)=>l==0?t:t.replace(/^\s+/,"")).join("")}postProcess(e,t){if(!e||t.oneChangePerToken)return e;let l=null,s=null,o=null;return e.forEach(n=>{n.added?s=n:n.removed?o=n:((s||o)&&ne(l,o,s,n),l=n,s=null,o=null)}),(s||o)&&ne(l,o,s,null),e}}const ye=new we;function De(i,e,t){return ye.diff(i,e,t)}function ne(i,e,t,l){if(e&&t){const s=$(e.value),o=N(e.value),n=$(t.value),c=N(t.value);if(i){const r=ee(s,n);i.value=Z(i.value,n,r),e.value=I(e.value,r),t.value=I(t.value,r)}if(l){const r=te(o,c);l.value=U(l.value,c,r),e.value=J(e.value,r),t.value=J(t.value,r)}}else if(t){if(i){const s=$(t.value);t.value=t.value.substring(s.length)}if(l){const s=$(l.value);l.value=l.value.substring(s.length)}}else if(i&&l){const s=$(l.value),o=$(e.value),n=N(e.value),c=ee(s,o);e.value=I(e.value,c);const r=te(I(s,c),n);e.value=J(e.value,r),l.value=U(l.value,s,r),i.value=Z(i.value,s,s.slice(0,s.length-r.length))}else if(l){const s=$(l.value),o=N(e.value),n=le(o,s);e.value=J(e.value,n)}else if(i){const s=N(i.value),o=$(e.value),n=le(s,o);e.value=I(e.value,n)}}const Te={class:"main-content flex-grow-1"},Le={class:"page-header-row"},Pe={class:"page-header-left"},ke={class:"page-title"},Se={class:"page-description"},We={class:"breadcrumb-custom"},Ee={"aria-label":"breadcrumb"},Oe={class:"breadcrumb mb-0"},Me={class:"breadcrumb-item"},$e={href:"#"},He={class:"breadcrumb-item"},Fe={href:"#"},je={class:"breadcrumb-item active","aria-current":"page"},Ae={class:"card tool-card"},Ie={class:"card-body py-3"},Ne={class:"action-row"},Ve={class:"status-text"},qe={key:0,class:"text-muted ms-2"},ze={class:"action-buttons"},Be={class:"diff-panel"},Re={class:"diff-header"},Je={class:"diff-header-title"},Ye={class:"height-controls"},Ue={class:"diff-editor"},Ze={class:"diff-textarea-wrapper"},Ge=["placeholder"],Qe=["innerHTML"],Xe={class:"diff-panel"},Ke={class:"diff-header"},et={class:"diff-header-title"},tt={class:"diff-editor"},lt={class:"diff-textarea-wrapper"},st=["placeholder"],nt=["innerHTML"],at={class:"card tool-card no-footer mt-4"},ot={class:"card-header"},it={class:"card-body"},rt={class:"notice-box"},ut=fe({__name:"TextDiffView",setup(i){const{t:e}=de(),t=_(""),l=_(""),s=_(""),o=_(""),n=_([]),c=_(!0),r=_(e("pages.textDiff.status.ready")),x=_("status-idle"),d=_("bi bi-circle"),T=_("medium"),P=_(""),b=_(null),C=_(null),y=_(null),D=_(null),F=_(null),v=_(null),k=_(null),w=(f,u,h)=>{x.value=`status-${f}`,r.value=u,d.value=h},H=f=>f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),j=()=>{const f=t.value.split(`
`),u=l.value.split(`
`),h=Math.max(f.length,u.length);n.value=[];for(let p=0;p<h;p++){const W=f[p]||"",L=u[p]||"";let M="same";W!==L&&(W?M="removed":M="added"),n.value.push({type:M,position:p/h*100})}},S=_(!1),O=f=>{const u=f==="left"?y.value:D.value,h=f==="left"?F.value:v.value;if(!u||!h)return;const p=u.scrollTop,W=u.scrollLeft,L=h.querySelector(".diff-overlay-content");L&&(L.style.transform=`translate(${-W}px, ${-p}px)`)},ae=()=>{if(S.value)return;if(S.value=!0,!y.value||!D.value||!b.value||!C.value){S.value=!1;return}const f=y.value.scrollTop;D.value.scrollTop=f,b.value.scrollTop=f,C.value.scrollTop=f,O("left"),O("right"),requestAnimationFrame(()=>{S.value=!1})},oe=()=>{if(S.value)return;if(S.value=!0,!y.value||!D.value||!b.value||!C.value){S.value=!1;return}const f=D.value.scrollTop;y.value.scrollTop=f,b.value.scrollTop=f,C.value.scrollTop=f,O("left"),O("right"),requestAnimationFrame(()=>{S.value=!1})},Y=()=>{if(!t.value&&!l.value){w("idle",e("pages.textDiff.status.ready"),"bi bi-circle"),s.value="",o.value="",n.value=[],P.value="";return}const f=performance.now(),u=De(t.value,l.value),h=performance.now();P.value=((h-f)/1e3).toFixed(3);let p="",W="",L=0;u.forEach(M=>{const z=H(M.value);M.added?(W+=`<span class="diff-added">${z}</span>`,L++):M.removed?(p+=`<span class="diff-removed">${z}</span>`,L++):(p+=z,W+=z)}),s.value=p,o.value=W,L>0?w("different",e("pages.textDiff.status.different",{count:L}),"bi bi-exclamation-triangle-fill"):w("same",e("pages.textDiff.status.same"),"bi bi-check-circle-fill"),j(),K(()=>{O("left"),O("right")})},V=()=>{K(()=>{const f=t.value.split(`
`).length,u=l.value.split(`
`).length;b.value&&(b.value.innerHTML=Array.from({length:f},(h,p)=>`<div>${p+1}</div>`).join("")),C.value&&(C.value.innerHTML=Array.from({length:u},(h,p)=>`<div>${p+1}</div>`).join(""))})},G=()=>{c.value&&(w("comparing",e("pages.textDiff.status.comparing"),"bi bi-arrow-repeat"),setTimeout(()=>{Y()},10)),V()},ie=()=>{c.value=!c.value,c.value?(w("comparing",e("pages.textDiff.status.autoCompareOn"),"bi bi-toggle-on"),Y()):w("idle",e("pages.textDiff.status.autoCompareOff"),"bi bi-toggle-off")},re=()=>{confirm(e("pages.textDiff.actions.clearConfirm"))&&(t.value="",l.value="",s.value="",o.value="",n.value=[],P.value="",w("cleared",e("pages.textDiff.status.cleared"),"bi bi-trash"),V())},ue=()=>{const f=t.value;t.value=l.value,l.value=f,w("comparing",e("pages.textDiff.status.swapped"),"bi bi-arrow-left-right"),c.value&&Y(),V()},q=f=>{T.value=f},ce=f=>{if(!k.value||!y.value||!D.value)return;const u=k.value.getBoundingClientRect(),p=(f.clientY-u.top)/u.height,W=y.value.scrollHeight*p,L=D.value.scrollHeight*p;y.value.scrollTop=W,D.value.scrollTop=L};return ve(()=>{V()}),(f,u)=>(R(),B("main",Te,[a("div",Le,[a("div",Pe,[a("h1",ke,g(m(e)("pages.textDiff.title")),1),a("p",Se,g(m(e)("pages.textDiff.description")),1)]),a("div",We,[a("nav",Ee,[a("ol",Oe,[a("li",Me,[a("a",$e,g(m(e)("breadcrumb.home")),1)]),a("li",He,[a("a",Fe,g(m(e)("breadcrumb.tools")),1)]),a("li",je,g(m(e)("pages.textDiff.title_short")),1)])])])]),a("div",Ae,[a("div",Ie,[a("div",Ne,[a("div",{class:E(["status-bar",x.value])},[a("i",{class:E(d.value)},null,2),a("span",Ve,[A(g(r.value)+" ",1),P.value?(R(),B("span",qe,"("+g(P.value)+"s)",1)):he("",!0)])],2),a("div",ze,[a("button",{class:E(["btn btn-action btn-compare",{inactive:!c.value}]),onClick:ie},[a("i",{class:E(c.value?"bi bi-toggle-on":"bi bi-toggle-off")},null,2),A(" "+g(c.value?m(e)("pages.textDiff.actions.autoCompareOn"):m(e)("pages.textDiff.actions.autoCompareOff")),1)],2),a("button",{class:"btn btn-action btn-clear",onClick:re},[u[6]||(u[6]=a("i",{class:"bi bi-trash"},null,-1)),A(" "+g(m(e)("pages.textDiff.actions.clear")),1)]),a("button",{class:"btn btn-action btn-swap",onClick:ue},[u[7]||(u[7]=a("i",{class:"bi bi-arrow-left-right"},null,-1)),A(" "+g(m(e)("pages.textDiff.actions.swap")),1)])])])])]),a("div",{class:E(["diff-container","height-"+T.value])},[a("div",Be,[a("div",Re,[a("span",Je,g(m(e)("pages.textDiff.panels.original")),1),a("div",Ye,[a("button",{class:E(["btn-height",{active:T.value==="small"}]),onClick:u[0]||(u[0]=h=>q("small"))},g(m(e)("pages.textDiff.height.small")),3),a("button",{class:E(["btn-height",{active:T.value==="medium"}]),onClick:u[1]||(u[1]=h=>q("medium"))},g(m(e)("pages.textDiff.height.medium")),3),a("button",{class:E(["btn-height",{active:T.value==="large"}]),onClick:u[2]||(u[2]=h=>q("large"))},g(m(e)("pages.textDiff.height.large")),3),a("button",{class:E(["btn-height",{active:T.value==="ex-large"}]),onClick:u[3]||(u[3]=h=>q("ex-large"))},g(m(e)("pages.textDiff.height.exLarge")),3)])]),a("div",Ue,[a("div",{class:"line-numbers",ref_key:"leftLineNumbers",ref:b},null,512),a("div",Ze,[Q(a("textarea",{class:"diff-textarea","onUpdate:modelValue":u[4]||(u[4]=h=>t.value=h),onInput:G,onScroll:ae,ref_key:"leftTextarea",ref:y,placeholder:m(e)("pages.textDiff.placeholders.original")},null,40,Ge),[[X,t.value]]),a("div",{class:"diff-overlay",ref_key:"leftOverlay",ref:F},[a("div",{class:"diff-overlay-content",innerHTML:s.value},null,8,Qe)],512)]),a("div",{class:"diff-map",onClick:ce,ref_key:"diffMapRef",ref:k},[(R(!0),B(me,null,ge(n.value,(h,p)=>(R(),B("div",{key:p,class:E(["diff-map-item",h.type]),style:pe({top:h.position+"%"})},null,6))),128))],512)])]),a("div",Xe,[a("div",Ke,[a("span",et,g(m(e)("pages.textDiff.panels.target")),1)]),a("div",tt,[a("div",{class:"line-numbers",ref_key:"rightLineNumbers",ref:C},null,512),a("div",lt,[Q(a("textarea",{class:"diff-textarea","onUpdate:modelValue":u[5]||(u[5]=h=>l.value=h),onInput:G,onScroll:oe,ref_key:"rightTextarea",ref:D,placeholder:m(e)("pages.textDiff.placeholders.target")},null,40,st),[[X,l.value]]),a("div",{class:"diff-overlay",ref_key:"rightOverlay",ref:v},[a("div",{class:"diff-overlay-content",innerHTML:o.value},null,8,nt)],512)])])])],2),a("div",at,[a("div",ot,[u[8]||(u[8]=a("i",{class:"bi bi-info-circle"},null,-1)),A(" "+g(m(e)("pages.textDiff.notice.title")),1)]),a("div",it,[a("div",rt,[a("ul",null,[a("li",null,g(m(e)("pages.textDiff.notice.item1")),1),a("li",null,g(m(e)("pages.textDiff.notice.item2")),1),a("li",null,g(m(e)("pages.textDiff.notice.item3")),1),a("li",null,g(m(e)("pages.textDiff.notice.item4")),1)])])])])]))}}),ft=xe(ut,[["__scopeId","data-v-78b1dffe"]]);export{ft as default};
