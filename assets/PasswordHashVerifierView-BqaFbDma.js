import{d as X,u as Y,r as c,c as L,k as Z,l as j,b as u,e,t as i,f as r,h as _,w as y,v as O,j as q,n as M,x as ee,y as se,T as te,p as ae,F as oe,i as re,g as ie,o as h,q as le,_ as ne}from"./index-BPLJ2CTL.js";import{b as ce,s as de,a as ue}from"./argon2-bundled.min-DN9-HiOH.js";const he={class:"main-content flex-grow-1"},pe={class:"page-header-row"},me={class:"page-header-left"},ve={class:"page-title"},ge={class:"page-description"},fe={class:"breadcrumb-custom"},be={"aria-label":"breadcrumb"},_e={class:"breadcrumb mb-0"},we={class:"breadcrumb-item"},ye={href:"#"},Ve={class:"breadcrumb-item"},xe={href:"#"},He={class:"breadcrumb-item active","aria-current":"page"},ke={class:"row"},Te={class:"col-lg-5 col-md-12 mb-3 mb-lg-0"},Ce={class:"card tool-card"},Me={class:"card-header"},Se={class:"card-body"},$e={class:"param-group"},Ae={class:"param-label"},Ie=["placeholder"],Le={class:"param-group d-flex align-items-center justify-content-between"},Oe={class:"param-label mb-0"},Pe=["title"],Ue={class:"cost-control d-flex align-items-center gap-3",style:{width:"200px"}},Ee={class:"badge bg-accent rounded-pill",style:{"min-width":"3em"}},We={class:"param-group mb-0"},Ge={class:"param-label"},Ne=["placeholder"],je={class:"card-footer"},qe={class:"control-row"},Fe={class:"auto-match-control"},Re={class:"auto-match-label"},Be={class:"switch"},De=["disabled"],ze={key:0,class:"bi bi-cpu"},Je={key:1,class:"spinner-border spinner-border-sm"},Ke={class:"control-row mt-2"},Qe={class:"auto-match-control"},Xe={class:"auto-match-label"},Ye={class:"switch"},Ze=["disabled"],es={key:0,class:"bi bi-search"},ss={key:1,class:"spinner-border spinner-border-sm"},ts={class:"d-flex align-items-center"},as=["innerHTML"],os={class:"col-lg-7 col-md-12"},rs={class:"card tool-card"},is={class:"card-header d-flex justify-content-between align-items-center card-header-with-controls"},ls={key:0,class:"text-success ms-2 fw-bold"},ns={key:1,class:"text-secondary ms-2"},cs={class:"encode-selector"},ds={class:"encode-label"},us=["data-bs-title"],hs={value:"original"},ps={value:"base64"},ms={value:"base64url"},vs={value:"hex"},gs={value:"base2"},fs={class:"card-body"},bs={key:0,class:"hash-results-container"},_s={class:"hash-results-list"},ws={class:"item-header"},ys={class:"algo-name"},Vs={key:0,class:"ms-2"},xs={class:"match-badge matched"},Hs={class:"item-hash"},ks={class:"hash-wrapper"},Ts=["value"],Cs=["onClick"],Ms={key:1,class:"empty-results"},Ss={class:"text-muted mt-1"},$s={class:"card tool-card no-footer mt-3"},As={class:"card-header"},Is={class:"card-body"},Ls={class:"notice-box"},Os=X({__name:"PasswordHashVerifierView",setup(Ps){const{t:o}=Y(),l=c(""),m=c(""),V=c(!1),p=c(!1),x=c(10),H=c("original"),v=c([]),d=c(null),k=c(null),T=c(!1),b=c(!1),w=c(!1),S=c(null);let $=null;const g=c({bcrypt:!1,scrypt:!1,argon2:!1}),F=L(()=>b.value?"calculating":!l.value&&!m.value||!l.value||!m.value||!p.value&&!w.value?"empty":d.value?"success":"no-match"),R=L(()=>b.value?"spinner-border spinner-border-sm":!l.value||!m.value||!p.value&&!w.value?"bi bi-info-circle text-secondary":d.value?"bi bi-check-circle-fill text-success":"bi bi-x-circle-fill text-danger"),B=L(()=>b.value?o("pages.passwordHashVerifier.status.matching"):!l.value&&!m.value?o("pages.passwordHashVerifier.status.waiting"):l.value?m.value?!p.value&&!w.value?o("pages.passwordHashVerifier.status.waitingManual"):d.value?o("pages.passwordHashVerifier.status.success",{algorithm:d.value}):o("pages.passwordHashVerifier.status.notFound"):o("pages.passwordHashVerifier.status.inputHash"):o("pages.passwordHashVerifier.status.inputPlaintext")),A=t=>new Promise((s,a)=>{if(document.querySelector(`script[src="${t}"]`)){s();return}const n=document.createElement("script");n.src=t,n.onload=()=>s(),n.onerror=()=>a(new Error(`Failed to load script: ${t}`)),document.head.appendChild(n)});Z(async()=>{try{await Promise.all([A(ce).then(()=>g.value.bcrypt=!0),A(de).then(()=>g.value.scrypt=!0),A(ue).then(()=>g.value.argon2=!0)])}catch(t){console.error("Failed to load crypto libraries",t)}});const P=t=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"},D=()=>{V.value&&U()},U=()=>{p.value||(w.value=!1,d.value=null),V.value&&($&&clearTimeout($),$=setTimeout(()=>{G()},500))},z=()=>{p.value||(w.value=!1,d.value=null),p.value&&l.value&&v.value.length>0&&C()},E=t=>{if(!t||t.startsWith("Error")||t.startsWith("Library")||H.value==="original")return t;try{const a=new TextEncoder().encode(t);switch(H.value){case"base64":return W(a);case"base64url":return W(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");case"hex":return J(a);case"base2":return Array.from(a).map(n=>n.toString(2).padStart(8,"0")).join(" ");default:return t}}catch{return t}},W=t=>{let s="";const a=new Uint8Array(t),n=a.byteLength;for(let f=0;f<n;f++)s+=String.fromCharCode(a[f]);return window.btoa(s)},J=t=>Array.from(t).map(s=>s.toString(16).padStart(2,"0")).join(""),G=async()=>{if(!l.value){v.value=[];return}T.value=!0;const t=[];try{if(g.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt){const s=await new Promise(a=>{window.dcodeIO.bcrypt.hash(l.value,x.value,(n,f)=>{a(f)})});t.push({algorithm:"bcrypt",value:s,raw:s,matched:!1})}if(g.value.scrypt&&window.scrypt){const s=new TextEncoder().encode(l.value),a=new TextEncoder().encode("salt"),Q=await window.scrypt.scrypt(s,a,16384,8,1,64),N=`$s0$e0801$${window.btoa("salt")}$${window.btoa(String.fromCharCode.apply(null,Array.from(Q)))}`;t.push({algorithm:"scrypt",value:N,raw:N,matched:!1})}if(g.value.argon2&&window.argon2)try{const s=await window.argon2.hash({pass:l.value,salt:"somesalt",type:window.argon2.Argon2id,time:2,mem:65536,hashLen:32});t.push({algorithm:"Argon2",value:s.encoded,raw:s.encoded,matched:!1})}catch(s){console.error("Argon2 error",s)}}catch(s){console.error("Generation error",s)}v.value=t,T.value=!1,S.value=new Date().toLocaleTimeString(),p.value&&m.value&&C()},C=async()=>{if(!l.value||!m.value){d.value=null;return}b.value=!0,w.value=!0,d.value=null,v.value.forEach(s=>s.matched=!1);const t=m.value.trim();try{if((t.startsWith("$2")||t.startsWith("$2a")||t.startsWith("$2y")||t.startsWith("$2b"))&&g.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt&&await new Promise(a=>{window.dcodeIO.bcrypt.compare(l.value,t,(n,f)=>{a(f)})})&&(d.value="bcrypt",I("bcrypt")),!d.value&&t.startsWith("$argon2")&&g.value.argon2&&window.argon2)try{await window.argon2.verify({pass:l.value,encoded:t}),d.value="Argon2",I("Argon2")}catch{}if(!d.value){const s=v.value.find(a=>a.algorithm==="scrypt");s&&s.raw===t&&(d.value="scrypt",I("scrypt"))}}catch(s){console.error("Match error",s)}b.value=!1},I=t=>{const s=v.value.find(a=>a.algorithm===t);s&&(s.matched=!0)},K=async(t,s)=>{try{await navigator.clipboard.writeText(t),k.value=s,setTimeout(()=>{k.value=null},2e3)}catch(a){console.error("Copy failed",a)}};return j(p,t=>{t&&v.value.length>0&&C()}),j(v,async()=>{await le(),document.querySelectorAll(".hash-value").forEach(s=>P(s))},{deep:!0}),(t,s)=>(h(),u("main",he,[e("div",pe,[e("div",me,[e("h1",ve,i(r(o)("pages.passwordHashVerifier.title")),1),e("p",ge,i(r(o)("pages.passwordHashVerifier.description")),1)]),e("div",fe,[e("nav",be,[e("ol",_e,[e("li",we,[e("a",ye,i(r(o)("breadcrumb.home")),1)]),e("li",Ve,[e("a",xe,i(r(o)("breadcrumb.tools")),1)]),e("li",He,i(r(o)("pages.passwordHashVerifier.title_short")),1)])])])]),e("div",ke,[e("div",Te,[e("div",Ce,[e("div",Me,[s[7]||(s[7]=e("i",{class:"bi bi-sliders"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.settings.title")),1)]),e("div",Se,[e("div",$e,[e("label",Ae,i(r(o)("pages.passwordHashVerifier.settings.plaintext"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[0]||(s[0]=a=>l.value=a),onInput:U,placeholder:r(o)("pages.passwordHashVerifier.settings.plaintextPlaceholder")},null,40,Ie),[[O,l.value]])]),e("div",Le,[e("div",Oe,[_(i(r(o)("pages.passwordHashVerifier.settings.costLabel"))+" ",1),e("i",{class:"bi bi-question-circle-fill text-muted","data-bs-toggle":"tooltip",title:r(o)("pages.passwordHashVerifier.settings.costTooltip")},null,8,Pe)]),e("div",Ue,[y(e("input",{type:"range",class:"form-range",min:"4",max:"31",step:"1","onUpdate:modelValue":s[1]||(s[1]=a=>x.value=a),onInput:D},null,544),[[O,x.value,void 0,{number:!0}]]),e("span",Ee,i(x.value),1)])]),e("div",We,[e("label",Ge,i(r(o)("pages.passwordHashVerifier.settings.hashToMatch"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a),onInput:z,placeholder:r(o)("pages.passwordHashVerifier.settings.hashPlaceholder")},null,40,Ne),[[O,m.value]])])]),e("div",je,[e("div",qe,[e("div",Fe,[e("span",Re,i(r(o)("pages.passwordHashVerifier.settings.autoGenerate")),1),e("label",Be,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=a=>V.value=a)},null,512),[[q,V.value]]),s[8]||(s[8]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"manual-match-btn",disabled:V.value||T.value,onClick:G},[T.value?(h(),u("span",Je)):(h(),u("i",ze)),_(" "+i(r(o)("pages.passwordHashVerifier.settings.manualGenerate")),1)],8,De)]),e("div",Ke,[e("div",Qe,[e("span",Xe,i(r(o)("pages.passwordHashVerifier.settings.autoMatch")),1),e("label",Ye,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=a=>p.value=a)},null,512),[[q,p.value]]),s[9]||(s[9]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"manual-match-btn",disabled:p.value||b.value,onClick:C},[b.value?(h(),u("span",ss)):(h(),u("i",es)),_(" "+i(r(o)("pages.passwordHashVerifier.settings.manualMatch")),1)],8,Ze)]),s[10]||(s[10]=e("div",{class:"board"},null,-1)),e("div",{class:M(["match-result-box",F.value])},[e("div",ts,[e("i",{class:M(["match-icon",R.value])},null,2),e("p",{class:"match-text",innerHTML:B.value},null,8,as)])],2)])])]),e("div",os,[e("div",rs,[e("div",is,[e("div",null,[s[12]||(s[12]=e("i",{class:"bi bi-list-check"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.results.title"))+" ",1),ee(te,{name:"fade",mode:"out-in"},{default:se(()=>[S.value?(h(),u("small",ls,[s[11]||(s[11]=e("i",{class:"bi bi-check-circle-fill me-1"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.results.generatedSuccess",{time:S.value})),1)])):(h(),u("small",ns,i(r(o)("pages.passwordHashVerifier.results.notGenerated")),1))]),_:1})]),e("div",cs,[e("label",ds,i(r(o)("pages.passwordHashVerifier.results.encoding"))+":",1),e("i",{class:"bi bi-question-circle-fill","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":r(o)("pages.passwordHashVerifier.results.encodingTooltip")},null,8,us),y(e("select",{class:"form-select form-select-sm encode-select","onUpdate:modelValue":s[5]||(s[5]=a=>H.value=a)},[e("option",hs,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.original")),1),e("option",ps,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.base64")),1),e("option",ms,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.base64url")),1),e("option",vs,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.hex")),1),e("option",gs,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.base2")),1)],512),[[ae,H.value]])])]),e("div",fs,[v.value.length>0?(h(),u("div",bs,[e("div",_s,[(h(!0),u(oe,null,re(v.value,a=>(h(),u("div",{class:"hash-result-item",key:a.algorithm},[e("div",ws,[e("span",ys,i(a.algorithm),1),a.matched?(h(),u("span",Vs,[e("span",xs,i(r(o)("pages.passwordHashVerifier.results.matched")),1)])):ie("",!0)]),e("div",Hs,[e("div",ks,[e("textarea",{class:"hash-value",value:E(a.value),onInput:s[6]||(s[6]=n=>P(n.target)),rows:"1",spellcheck:"false"},null,40,Ts),e("button",{class:M(["copy-hash-btn",{copied:k.value===a.algorithm}]),onClick:n=>K(E(a.value),a.algorithm)},[e("i",{class:M(k.value===a.algorithm?"bi bi-check-lg":"bi bi-clipboard")},null,2)],10,Cs)])])]))),128))])])):(h(),u("div",Ms,[s[13]||(s[13]=e("i",{class:"bi bi-fingerprint"},null,-1)),e("p",null,i(r(o)("pages.passwordHashVerifier.results.empty")),1),e("p",Ss,i(r(o)("pages.passwordHashVerifier.results.emptyHint")),1)]))])])])]),e("div",$s,[e("div",As,[s[14]||(s[14]=e("i",{class:"bi bi-info-circle"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.notice.title")),1)]),e("div",Is,[e("div",Ls,[e("ul",null,[e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item1")),1),e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item2")),1),e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item3")),1),e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item4")),1)])])])])]))}}),Ns=ne(Os,[["__scopeId","data-v-49e83263"]]);export{Ns as default};
