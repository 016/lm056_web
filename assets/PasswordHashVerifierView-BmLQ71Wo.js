import{d as X,u as Y,r as c,c as I,k as Z,l as N,b as u,e,t as i,f as r,h as _,w as y,v as L,j as q,n as M,x as ee,y as se,T as te,p as ae,F as oe,i as re,g as ie,o as p,q as le,_ as ne}from"./index-BptgdAIT.js";const ce={class:"main-content flex-grow-1"},de={class:"page-header-row"},ue={class:"page-header-left"},pe={class:"page-title"},he={class:"page-description"},me={class:"breadcrumb-custom"},ve={"aria-label":"breadcrumb"},fe={class:"breadcrumb mb-0"},ge={class:"breadcrumb-item"},be={href:"#"},_e={class:"breadcrumb-item"},we={href:"#"},ye={class:"breadcrumb-item active","aria-current":"page"},xe={class:"row"},Ve={class:"col-lg-5 col-md-12 mb-3 mb-lg-0"},He={class:"card tool-card"},ke={class:"card-header"},Te={class:"card-body"},Ce={class:"param-group"},je={class:"param-label"},Me=["placeholder"],Se={class:"param-group d-flex align-items-center justify-content-between"},$e={class:"param-label mb-0"},Ae=["title"],Ie={class:"cost-control d-flex align-items-center gap-3",style:{width:"200px"}},Le={class:"badge bg-accent rounded-pill",style:{"min-width":"3em"}},Oe={class:"param-group mb-0"},Pe={class:"param-label"},Ee=["placeholder"],Ue={class:"card-footer"},We={class:"control-row"},Ge={class:"auto-match-control"},Ne={class:"auto-match-label"},qe={class:"switch"},Fe=["disabled"],Re={key:0,class:"bi bi-cpu"},Be={key:1,class:"spinner-border spinner-border-sm"},De={class:"control-row mt-2"},ze={class:"auto-match-control"},Ke={class:"auto-match-label"},Je={class:"switch"},Qe=["disabled"],Xe={key:0,class:"bi bi-search"},Ye={key:1,class:"spinner-border spinner-border-sm"},Ze={class:"d-flex align-items-center"},es=["innerHTML"],ss={class:"col-lg-7 col-md-12"},ts={class:"card tool-card"},as={class:"card-header d-flex justify-content-between align-items-center card-header-with-controls"},os={key:0,class:"text-success ms-2 fw-bold"},rs={key:1,class:"text-secondary ms-2"},is={class:"encode-selector"},ls={class:"encode-label"},ns=["data-bs-title"],cs={value:"original"},ds={value:"base64"},us={value:"base64url"},ps={value:"hex"},hs={value:"base2"},ms={class:"card-body"},vs={key:0,class:"hash-results-container"},fs={class:"hash-results-list"},gs={class:"item-header"},bs={class:"algo-name"},_s={key:0,class:"ms-2"},ws={class:"match-badge matched"},ys={class:"item-hash"},xs={class:"hash-wrapper"},Vs=["value"],Hs=["onClick"],ks={key:1,class:"empty-results"},Ts={class:"text-muted mt-1"},Cs={class:"card tool-card no-footer mt-3"},js={class:"card-header"},Ms={class:"card-body"},Ss={class:"notice-box"},$s=X({__name:"PasswordHashVerifierView",setup(As){const{t:o}=Y(),l=c(""),m=c(""),x=c(!1),h=c(!1),V=c(10),H=c("original"),v=c([]),d=c(null),k=c(null),T=c(!1),b=c(!1),w=c(!1),S=c(null);let $=null;const f=c({bcrypt:!1,scrypt:!1,argon2:!1}),F=I(()=>b.value?"calculating":!l.value&&!m.value||!l.value||!m.value||!h.value&&!w.value?"empty":d.value?"success":"no-match"),R=I(()=>b.value?"spinner-border spinner-border-sm":!l.value||!m.value||!h.value&&!w.value?"bi bi-info-circle text-secondary":d.value?"bi bi-check-circle-fill text-success":"bi bi-x-circle-fill text-danger"),B=I(()=>b.value?o("pages.passwordHashVerifier.status.matching"):!l.value&&!m.value?o("pages.passwordHashVerifier.status.waiting"):l.value?m.value?!h.value&&!w.value?o("pages.passwordHashVerifier.status.waitingManual"):d.value?o("pages.passwordHashVerifier.status.success",{algorithm:d.value}):o("pages.passwordHashVerifier.status.notFound"):o("pages.passwordHashVerifier.status.inputHash"):o("pages.passwordHashVerifier.status.inputPlaintext")),C=t=>new Promise((s,a)=>{if(document.querySelector(`script[src="${t}"]`)){s();return}const n=document.createElement("script");n.src=t,n.onload=()=>s(),n.onerror=()=>a(new Error(`Failed to load script: ${t}`)),document.head.appendChild(n)});Z(async()=>{try{await Promise.all([C("https://cdnjs.cloudflare.com/ajax/libs/bcryptjs/2.4.3/bcrypt.min.js").then(()=>f.value.bcrypt=!0),C("https://unpkg.com/scrypt-js@3.0.1/scrypt.js").then(()=>f.value.scrypt=!0),C("https://cdnjs.cloudflare.com/ajax/libs/argon2-browser/1.18.0/argon2-bundled.min.js").then(()=>f.value.argon2=!0),C("https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js")])}catch(t){console.error("Failed to load crypto libraries",t)}});const O=t=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"},D=()=>{x.value&&P()},P=()=>{h.value||(w.value=!1,d.value=null),x.value&&($&&clearTimeout($),$=setTimeout(()=>{W()},500))},z=()=>{h.value||(w.value=!1,d.value=null),h.value&&l.value&&v.value.length>0&&j()},E=t=>{if(!t||t.startsWith("Error")||t.startsWith("Library")||H.value==="original")return t;try{const a=new TextEncoder().encode(t);switch(H.value){case"base64":return U(a);case"base64url":return U(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");case"hex":return K(a);case"base2":return Array.from(a).map(n=>n.toString(2).padStart(8,"0")).join(" ");default:return t}}catch{return t}},U=t=>{let s="";const a=new Uint8Array(t),n=a.byteLength;for(let g=0;g<n;g++)s+=String.fromCharCode(a[g]);return window.btoa(s)},K=t=>Array.from(t).map(s=>s.toString(16).padStart(2,"0")).join(""),W=async()=>{if(!l.value){v.value=[];return}T.value=!0;const t=[];try{if(f.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt){const s=await new Promise(a=>{window.dcodeIO.bcrypt.hash(l.value,V.value,(n,g)=>{a(g)})});t.push({algorithm:"bcrypt",value:s,raw:s,matched:!1})}if(f.value.scrypt&&window.scrypt){const s=new TextEncoder().encode(l.value),a=new TextEncoder().encode("salt"),Q=await window.scrypt.scrypt(s,a,16384,8,1,64),G=`$s0$e0801$${window.btoa("salt")}$${window.btoa(String.fromCharCode.apply(null,Array.from(Q)))}`;t.push({algorithm:"scrypt",value:G,raw:G,matched:!1})}if(f.value.argon2&&window.argon2)try{const s=await window.argon2.hash({pass:l.value,salt:"somesalt",type:window.argon2.Argon2id,time:2,mem:65536,hashLen:32});t.push({algorithm:"Argon2",value:s.encoded,raw:s.encoded,matched:!1})}catch(s){console.error("Argon2 error",s)}}catch(s){console.error("Generation error",s)}v.value=t,T.value=!1,S.value=new Date().toLocaleTimeString(),h.value&&m.value&&j()},j=async()=>{if(!l.value||!m.value){d.value=null;return}b.value=!0,w.value=!0,d.value=null,v.value.forEach(s=>s.matched=!1);const t=m.value.trim();try{if((t.startsWith("$2")||t.startsWith("$2a")||t.startsWith("$2y")||t.startsWith("$2b"))&&f.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt&&await new Promise(a=>{window.dcodeIO.bcrypt.compare(l.value,t,(n,g)=>{a(g)})})&&(d.value="bcrypt",A("bcrypt")),!d.value&&t.startsWith("$argon2")&&f.value.argon2&&window.argon2)try{await window.argon2.verify({pass:l.value,encoded:t}),d.value="Argon2",A("Argon2")}catch{}if(!d.value){const s=v.value.find(a=>a.algorithm==="scrypt");s&&s.raw===t&&(d.value="scrypt",A("scrypt"))}}catch(s){console.error("Match error",s)}b.value=!1},A=t=>{const s=v.value.find(a=>a.algorithm===t);s&&(s.matched=!0)},J=async(t,s)=>{try{await navigator.clipboard.writeText(t),k.value=s,setTimeout(()=>{k.value=null},2e3)}catch(a){console.error("Copy failed",a)}};return N(h,t=>{t&&v.value.length>0&&j()}),N(v,async()=>{await le(),document.querySelectorAll(".hash-value").forEach(s=>O(s))},{deep:!0}),(t,s)=>(p(),u("main",ce,[e("div",de,[e("div",ue,[e("h1",pe,i(r(o)("pages.passwordHashVerifier.title")),1),e("p",he,i(r(o)("pages.passwordHashVerifier.description")),1)]),e("div",me,[e("nav",ve,[e("ol",fe,[e("li",ge,[e("a",be,i(r(o)("breadcrumb.home")),1)]),e("li",_e,[e("a",we,i(r(o)("breadcrumb.tools")),1)]),e("li",ye,i(r(o)("pages.passwordHashVerifier.title_short")),1)])])])]),e("div",xe,[e("div",Ve,[e("div",He,[e("div",ke,[s[7]||(s[7]=e("i",{class:"bi bi-sliders"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.settings.title")),1)]),e("div",Te,[e("div",Ce,[e("label",je,i(r(o)("pages.passwordHashVerifier.settings.plaintext"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[0]||(s[0]=a=>l.value=a),onInput:P,placeholder:r(o)("pages.passwordHashVerifier.settings.plaintextPlaceholder")},null,40,Me),[[L,l.value]])]),e("div",Se,[e("div",$e,[_(i(r(o)("pages.passwordHashVerifier.settings.costLabel"))+" ",1),e("i",{class:"bi bi-question-circle-fill text-muted","data-bs-toggle":"tooltip",title:r(o)("pages.passwordHashVerifier.settings.costTooltip")},null,8,Ae)]),e("div",Ie,[y(e("input",{type:"range",class:"form-range",min:"4",max:"31",step:"1","onUpdate:modelValue":s[1]||(s[1]=a=>V.value=a),onInput:D},null,544),[[L,V.value,void 0,{number:!0}]]),e("span",Le,i(V.value),1)])]),e("div",Oe,[e("label",Pe,i(r(o)("pages.passwordHashVerifier.settings.hashToMatch"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[2]||(s[2]=a=>m.value=a),onInput:z,placeholder:r(o)("pages.passwordHashVerifier.settings.hashPlaceholder")},null,40,Ee),[[L,m.value]])])]),e("div",Ue,[e("div",We,[e("div",Ge,[e("span",Ne,i(r(o)("pages.passwordHashVerifier.settings.autoGenerate")),1),e("label",qe,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=a=>x.value=a)},null,512),[[q,x.value]]),s[8]||(s[8]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"manual-match-btn",disabled:x.value||T.value,onClick:W},[T.value?(p(),u("span",Be)):(p(),u("i",Re)),_(" "+i(r(o)("pages.passwordHashVerifier.settings.manualGenerate")),1)],8,Fe)]),e("div",De,[e("div",ze,[e("span",Ke,i(r(o)("pages.passwordHashVerifier.settings.autoMatch")),1),e("label",Je,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=a=>h.value=a)},null,512),[[q,h.value]]),s[9]||(s[9]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"manual-match-btn",disabled:h.value||b.value,onClick:j},[b.value?(p(),u("span",Ye)):(p(),u("i",Xe)),_(" "+i(r(o)("pages.passwordHashVerifier.settings.manualMatch")),1)],8,Qe)]),s[10]||(s[10]=e("div",{class:"board"},null,-1)),e("div",{class:M(["match-result-box",F.value])},[e("div",Ze,[e("i",{class:M(["match-icon",R.value])},null,2),e("p",{class:"match-text",innerHTML:B.value},null,8,es)])],2)])])]),e("div",ss,[e("div",ts,[e("div",as,[e("div",null,[s[12]||(s[12]=e("i",{class:"bi bi-list-check"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.results.title"))+" ",1),ee(te,{name:"fade",mode:"out-in"},{default:se(()=>[S.value?(p(),u("small",os,[s[11]||(s[11]=e("i",{class:"bi bi-check-circle-fill me-1"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.results.generatedSuccess",{time:S.value})),1)])):(p(),u("small",rs,i(r(o)("pages.passwordHashVerifier.results.notGenerated")),1))]),_:1})]),e("div",is,[e("label",ls,i(r(o)("pages.passwordHashVerifier.results.encoding"))+":",1),e("i",{class:"bi bi-question-circle-fill","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":r(o)("pages.passwordHashVerifier.results.encodingTooltip")},null,8,ns),y(e("select",{class:"form-select form-select-sm encode-select","onUpdate:modelValue":s[5]||(s[5]=a=>H.value=a)},[e("option",cs,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.original")),1),e("option",ds,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.base64")),1),e("option",us,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.base64url")),1),e("option",ps,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.hex")),1),e("option",hs,i(r(o)("pages.passwordHashVerifier.results.encodingOptions.base2")),1)],512),[[ae,H.value]])])]),e("div",ms,[v.value.length>0?(p(),u("div",vs,[e("div",fs,[(p(!0),u(oe,null,re(v.value,a=>(p(),u("div",{class:"hash-result-item",key:a.algorithm},[e("div",gs,[e("span",bs,i(a.algorithm),1),a.matched?(p(),u("span",_s,[e("span",ws,i(r(o)("pages.passwordHashVerifier.results.matched")),1)])):ie("",!0)]),e("div",ys,[e("div",xs,[e("textarea",{class:"hash-value",value:E(a.value),onInput:s[6]||(s[6]=n=>O(n.target)),rows:"1",spellcheck:"false"},null,40,Vs),e("button",{class:M(["copy-hash-btn",{copied:k.value===a.algorithm}]),onClick:n=>J(E(a.value),a.algorithm)},[e("i",{class:M(k.value===a.algorithm?"bi bi-check-lg":"bi bi-clipboard")},null,2)],10,Hs)])])]))),128))])])):(p(),u("div",ks,[s[13]||(s[13]=e("i",{class:"bi bi-fingerprint"},null,-1)),e("p",null,i(r(o)("pages.passwordHashVerifier.results.empty")),1),e("p",Ts,i(r(o)("pages.passwordHashVerifier.results.emptyHint")),1)]))])])])]),e("div",Cs,[e("div",js,[s[14]||(s[14]=e("i",{class:"bi bi-info-circle"},null,-1)),_(" "+i(r(o)("pages.passwordHashVerifier.notice.title")),1)]),e("div",Ms,[e("div",Ss,[e("ul",null,[e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item1")),1),e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item2")),1),e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item3")),1),e("li",null,i(r(o)("pages.passwordHashVerifier.notice.item4")),1)])])])])]))}}),Ps=ne($s,[["__scopeId","data-v-f97d1a23"]]);export{Ps as default};
