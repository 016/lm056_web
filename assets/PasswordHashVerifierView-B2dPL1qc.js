import{d as Q,u as X,r as d,c as I,k as Y,l as G,b as u,e,t as i,f as r,h as _,w as y,v as A,j as N,n as j,s as q,y as Z,T as ee,p as se,F as te,i as ae,g as oe,o as p,q as re,_ as ie}from"./index-B816jplU.js";import{C as le}from"./CopyButton-DU-AvUIZ.js";import{b as ne,s as ce,a as de}from"./argon2-bundled.min-DN9-HiOH.js";const ue={class:"main-content flex-grow-1"},pe={class:"page-header-row"},he={class:"page-header-left"},me={class:"page-title"},ve={class:"page-description"},fe={class:"breadcrumb-custom"},ge={"aria-label":"breadcrumb"},be={class:"breadcrumb mb-0"},_e={class:"breadcrumb-item"},we={href:"#"},ye={class:"breadcrumb-item"},Ve={href:"#"},xe={class:"breadcrumb-item active","aria-current":"page"},He={class:"row"},ke={class:"col-lg-5 col-md-12 mb-3 mb-lg-0"},Te={class:"card tool-card"},Ce={class:"card-header"},Me={class:"card-body"},Se={class:"param-group"},$e={class:"param-label"},Ie=["placeholder"],Ae={class:"param-group d-flex align-items-center justify-content-between"},Le={class:"param-label mb-0"},Oe=["title"],Pe={class:"cost-control d-flex align-items-center gap-3",style:{width:"200px"}},Ue={class:"badge bg-accent rounded-pill",style:{"min-width":"3em"}},Ee={class:"param-group mb-0"},We={class:"param-label"},Ge=["placeholder"],Ne={class:"card-footer"},je={class:"control-row"},qe={class:"auto-match-control"},Be={class:"auto-match-label"},Fe={class:"switch"},Re=["disabled"],De={key:0,class:"bi bi-cpu"},ze={key:1,class:"spinner-border spinner-border-sm"},Je={class:"control-row mt-2"},Ke={class:"auto-match-control"},Qe={class:"auto-match-label"},Xe={class:"switch"},Ye=["disabled"],Ze={key:0,class:"bi bi-search"},es={key:1,class:"spinner-border spinner-border-sm"},ss={class:"d-flex align-items-center"},ts=["innerHTML"],as={class:"col-lg-7 col-md-12"},os={class:"card tool-card"},rs={class:"card-header d-flex justify-content-between align-items-center card-header-with-controls"},is={key:0,class:"text-success ms-2 fw-bold"},ls={key:1,class:"text-secondary ms-2"},ns={class:"encode-selector"},cs={class:"encode-label"},ds=["data-bs-title"],us={value:"original"},ps={value:"base64"},hs={value:"base64url"},ms={value:"hex"},vs={value:"base2"},fs={class:"card-body"},gs={key:0,class:"hash-results-container"},bs={class:"hash-results-list"},_s={class:"item-header"},ws={class:"algo-name"},ys={key:0,class:"ms-2"},Vs={class:"match-badge matched"},xs={class:"item-hash"},Hs={class:"hash-wrapper"},ks=["value"],Ts={key:1,class:"empty-results"},Cs={class:"text-muted mt-1"},Ms={class:"card tool-card no-footer mt-3"},Ss={class:"card-header"},$s={class:"card-body"},Is={class:"notice-box"},As=Q({__name:"PasswordHashVerifierView",setup(Ls){const{t:a}=X(),l=d(""),m=d(""),V=d(!1),h=d(!1),x=d(10),H=d("original"),v=d([]),n=d(null),k=d(!1),b=d(!1),w=d(!1),C=d(null);let M=null;const f=d({bcrypt:!1,scrypt:!1,argon2:!1}),B=I(()=>b.value?"calculating":!l.value&&!m.value||!l.value||!m.value||!h.value&&!w.value?"empty":n.value?"success":"no-match"),F=I(()=>b.value?"spinner-border spinner-border-sm":!l.value||!m.value||!h.value&&!w.value?"bi bi-info-circle text-secondary":n.value?"bi bi-check-circle-fill text-success":"bi bi-x-circle-fill text-danger"),R=I(()=>b.value?a("pages.passwordHashVerifier.status.matching"):!l.value&&!m.value?a("pages.passwordHashVerifier.status.waiting"):l.value?m.value?!h.value&&!w.value?a("pages.passwordHashVerifier.status.waitingManual"):n.value?a("pages.passwordHashVerifier.status.success",{algorithm:n.value}):a("pages.passwordHashVerifier.status.notFound"):a("pages.passwordHashVerifier.status.inputHash"):a("pages.passwordHashVerifier.status.inputPlaintext")),S=t=>new Promise((s,o)=>{if(document.querySelector(`script[src="${t}"]`)){s();return}const c=document.createElement("script");c.src=t,c.onload=()=>s(),c.onerror=()=>o(new Error(`Failed to load script: ${t}`)),document.head.appendChild(c)});Y(async()=>{try{await Promise.all([S(ne).then(()=>f.value.bcrypt=!0),S(ce).then(()=>f.value.scrypt=!0),S(de).then(()=>f.value.argon2=!0)])}catch(t){console.error("Failed to load crypto libraries",t)}});const L=t=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"},D=()=>{V.value&&O()},O=()=>{h.value||(w.value=!1,n.value=null),V.value&&(M&&clearTimeout(M),M=setTimeout(()=>{E()},500))},z=()=>{h.value||(w.value=!1,n.value=null),h.value&&l.value&&v.value.length>0&&T()},P=t=>{if(!t||t.startsWith("Error")||t.startsWith("Library")||H.value==="original")return t;try{const o=new TextEncoder().encode(t);switch(H.value){case"base64":return U(o);case"base64url":return U(o).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");case"hex":return J(o);case"base2":return Array.from(o).map(c=>c.toString(2).padStart(8,"0")).join(" ");default:return t}}catch{return t}},U=t=>{let s="";const o=new Uint8Array(t),c=o.byteLength;for(let g=0;g<c;g++)s+=String.fromCharCode(o[g]);return window.btoa(s)},J=t=>Array.from(t).map(s=>s.toString(16).padStart(2,"0")).join(""),E=async()=>{if(!l.value){v.value=[];return}k.value=!0;const t=[];try{if(f.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt){const s=await new Promise(o=>{window.dcodeIO.bcrypt.hash(l.value,x.value,(c,g)=>{o(g)})});t.push({algorithm:"bcrypt",value:s,raw:s,matched:!1})}if(f.value.scrypt&&window.scrypt){const s=new TextEncoder().encode(l.value),o=new TextEncoder().encode("salt"),K=await window.scrypt.scrypt(s,o,16384,8,1,64),W=`$s0$e0801$${window.btoa("salt")}$${window.btoa(String.fromCharCode.apply(null,Array.from(K)))}`;t.push({algorithm:"scrypt",value:W,raw:W,matched:!1})}if(f.value.argon2&&window.argon2)try{const s=await window.argon2.hash({pass:l.value,salt:"somesalt",type:window.argon2.Argon2id,time:2,mem:65536,hashLen:32});t.push({algorithm:"Argon2",value:s.encoded,raw:s.encoded,matched:!1})}catch(s){console.error("Argon2 error",s)}}catch(s){console.error("Generation error",s)}v.value=t,k.value=!1,C.value=new Date().toLocaleTimeString(),h.value&&m.value&&T()},T=async()=>{if(!l.value||!m.value){n.value=null;return}b.value=!0,w.value=!0,n.value=null,v.value.forEach(s=>s.matched=!1);const t=m.value.trim();try{if((t.startsWith("$2")||t.startsWith("$2a")||t.startsWith("$2y")||t.startsWith("$2b"))&&f.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt&&await new Promise(o=>{window.dcodeIO.bcrypt.compare(l.value,t,(c,g)=>{o(g)})})&&(n.value="bcrypt",$("bcrypt")),!n.value&&t.startsWith("$argon2")&&f.value.argon2&&window.argon2)try{await window.argon2.verify({pass:l.value,encoded:t}),n.value="Argon2",$("Argon2")}catch{}if(!n.value){const s=v.value.find(o=>o.algorithm==="scrypt");s&&s.raw===t&&(n.value="scrypt",$("scrypt"))}}catch(s){console.error("Match error",s)}b.value=!1},$=t=>{const s=v.value.find(o=>o.algorithm===t);s&&(s.matched=!0)};return G(h,t=>{t&&v.value.length>0&&T()}),G(v,async()=>{await re(),document.querySelectorAll(".hash-value").forEach(s=>L(s))},{deep:!0}),(t,s)=>(p(),u("main",ue,[e("div",pe,[e("div",he,[e("h1",me,i(r(a)("pages.passwordHashVerifier.title")),1),e("p",ve,i(r(a)("pages.passwordHashVerifier.description")),1)]),e("div",fe,[e("nav",ge,[e("ol",be,[e("li",_e,[e("a",we,i(r(a)("breadcrumb.home")),1)]),e("li",ye,[e("a",Ve,i(r(a)("breadcrumb.tools")),1)]),e("li",xe,i(r(a)("pages.passwordHashVerifier.title_short")),1)])])])]),e("div",He,[e("div",ke,[e("div",Te,[e("div",Ce,[s[7]||(s[7]=e("i",{class:"bi bi-sliders"},null,-1)),_(" "+i(r(a)("pages.passwordHashVerifier.settings.title")),1)]),e("div",Me,[e("div",Se,[e("label",$e,i(r(a)("pages.passwordHashVerifier.settings.plaintext"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[0]||(s[0]=o=>l.value=o),onInput:O,placeholder:r(a)("pages.passwordHashVerifier.settings.plaintextPlaceholder")},null,40,Ie),[[A,l.value]])]),e("div",Ae,[e("div",Le,[_(i(r(a)("pages.passwordHashVerifier.settings.costLabel"))+" ",1),e("i",{class:"bi bi-question-circle-fill text-muted","data-bs-toggle":"tooltip",title:r(a)("pages.passwordHashVerifier.settings.costTooltip")},null,8,Oe)]),e("div",Pe,[y(e("input",{type:"range",class:"form-range",min:"4",max:"31",step:"1","onUpdate:modelValue":s[1]||(s[1]=o=>x.value=o),onInput:D},null,544),[[A,x.value,void 0,{number:!0}]]),e("span",Ue,i(x.value),1)])]),e("div",Ee,[e("label",We,i(r(a)("pages.passwordHashVerifier.settings.hashToMatch"))+":",1),y(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[2]||(s[2]=o=>m.value=o),onInput:z,placeholder:r(a)("pages.passwordHashVerifier.settings.hashPlaceholder")},null,40,Ge),[[A,m.value]])])]),e("div",Ne,[e("div",je,[e("div",qe,[e("span",Be,i(r(a)("pages.passwordHashVerifier.settings.autoGenerate")),1),e("label",Fe,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=o=>V.value=o)},null,512),[[N,V.value]]),s[8]||(s[8]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"btn btn-ee-base active",disabled:V.value||!l.value||k.value,onClick:E},[k.value?(p(),u("span",ze)):(p(),u("i",De)),_(" "+i(r(a)("pages.passwordHashVerifier.settings.manualGenerate")),1)],8,Re)]),e("div",Je,[e("div",Ke,[e("span",Qe,i(r(a)("pages.passwordHashVerifier.settings.autoMatch")),1),e("label",Xe,[y(e("input",{type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=o=>h.value=o)},null,512),[[N,h.value]]),s[9]||(s[9]=e("span",{class:"slider-switch"},null,-1))])]),e("button",{class:"btn btn-ee-base active",disabled:h.value||b.value,onClick:T},[b.value?(p(),u("span",es)):(p(),u("i",Ze)),_(" "+i(r(a)("pages.passwordHashVerifier.settings.manualMatch")),1)],8,Ye)]),s[10]||(s[10]=e("div",{class:"board"},null,-1)),e("div",{class:j(["match-result-box",B.value])},[e("div",ss,[e("i",{class:j(["match-icon",F.value])},null,2),e("p",{class:"match-text",innerHTML:R.value},null,8,ts)])],2)])])]),e("div",as,[e("div",os,[e("div",rs,[e("div",null,[s[12]||(s[12]=e("i",{class:"bi bi-list-check"},null,-1)),_(" "+i(r(a)("pages.passwordHashVerifier.results.title"))+" ",1),q(ee,{name:"fade",mode:"out-in"},{default:Z(()=>[C.value?(p(),u("small",is,[s[11]||(s[11]=e("i",{class:"bi bi-check-circle-fill me-1"},null,-1)),_(" "+i(r(a)("pages.passwordHashVerifier.results.generatedSuccess",{time:C.value})),1)])):(p(),u("small",ls,i(r(a)("pages.passwordHashVerifier.results.notGenerated")),1))]),_:1})]),e("div",ns,[e("label",cs,i(r(a)("pages.passwordHashVerifier.results.encoding"))+":",1),e("i",{class:"bi bi-question-circle-fill","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":r(a)("pages.passwordHashVerifier.results.encodingTooltip")},null,8,ds),y(e("select",{class:"form-select form-select-sm encode-select","onUpdate:modelValue":s[5]||(s[5]=o=>H.value=o)},[e("option",us,i(r(a)("pages.passwordHashVerifier.results.encodingOptions.original")),1),e("option",ps,i(r(a)("pages.passwordHashVerifier.results.encodingOptions.base64")),1),e("option",hs,i(r(a)("pages.passwordHashVerifier.results.encodingOptions.base64url")),1),e("option",ms,i(r(a)("pages.passwordHashVerifier.results.encodingOptions.hex")),1),e("option",vs,i(r(a)("pages.passwordHashVerifier.results.encodingOptions.base2")),1)],512),[[se,H.value]])])]),e("div",fs,[v.value.length>0?(p(),u("div",gs,[e("div",bs,[(p(!0),u(te,null,ae(v.value,o=>(p(),u("div",{class:"hash-result-item",key:o.algorithm},[e("div",_s,[e("span",ws,i(o.algorithm),1),o.matched?(p(),u("span",ys,[e("span",Vs,i(r(a)("pages.passwordHashVerifier.results.matched")),1)])):oe("",!0)]),e("div",xs,[e("div",Hs,[e("textarea",{class:"hash-value",value:P(o.value),onInput:s[6]||(s[6]=c=>L(c.target)),rows:"1",spellcheck:"false"},null,40,ks),q(le,{text:P(o.value)},null,8,["text"])])])]))),128))])])):(p(),u("div",Ts,[s[13]||(s[13]=e("i",{class:"bi bi-fingerprint"},null,-1)),e("p",null,i(r(a)("pages.passwordHashVerifier.results.empty")),1),e("p",Cs,i(r(a)("pages.passwordHashVerifier.results.emptyHint")),1)]))])])])]),e("div",Ms,[e("div",Ss,[s[14]||(s[14]=e("i",{class:"bi bi-info-circle"},null,-1)),_(" "+i(r(a)("pages.passwordHashVerifier.notice.title")),1)]),e("div",$s,[e("div",Is,[e("ul",null,[e("li",null,i(r(a)("pages.passwordHashVerifier.notice.item1")),1),e("li",null,i(r(a)("pages.passwordHashVerifier.notice.item2")),1),e("li",null,i(r(a)("pages.passwordHashVerifier.notice.item3")),1),e("li",null,i(r(a)("pages.passwordHashVerifier.notice.item4")),1)])])])])]))}}),Gs=ie(As,[["__scopeId","data-v-f54f5c18"]]);export{Gs as default};
