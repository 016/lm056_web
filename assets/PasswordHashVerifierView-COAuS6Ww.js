import{d as Q,u as X,r as d,c as A,k as Y,l as N,b as u,e,t as i,f as o,h as _,w as k,v as L,j as C,n as j,y as Z,T as ee,p as se,F as te,i as ae,g as re,o as p,s as oe,_ as ie}from"./index-C4d0zKoG.js";import{C as le}from"./CopyButton-C5pSyASS.js";import{T as B}from"./ToggleSwitch-Cjk9m-8X.js";import{b as ne,s as ce,a as de}from"./argon2-bundled.min-DN9-HiOH.js";const ue={class:"main-content flex-grow-1"},pe={class:"page-header-row"},he={class:"page-header-left"},me={class:"page-title"},ve={class:"page-description"},fe={class:"breadcrumb-custom"},ge={"aria-label":"breadcrumb"},be={class:"breadcrumb mb-0"},_e={class:"breadcrumb-item"},we={href:"#"},ye={class:"breadcrumb-item"},Ve={href:"#"},He={class:"breadcrumb-item active","aria-current":"page"},xe={class:"row"},Te={class:"col-lg-5 col-md-12 mb-3 mb-lg-0"},ke={class:"card tool-card"},Ce={class:"card-header"},Me={class:"card-body"},Se={class:"param-group"},$e={class:"param-label"},Ie=["placeholder"],Ae={class:"param-group d-flex align-items-center justify-content-between"},Le={class:"param-label mb-0"},Oe=["title"],Pe={class:"cost-control d-flex align-items-center gap-3",style:{width:"200px"}},Ue={class:"badge bg-accent rounded-pill",style:{"min-width":"3em"}},Ee={class:"param-group mb-0"},We={class:"param-label"},Ge=["placeholder"],Ne={class:"card-footer"},je={class:"control-row"},Be=["disabled"],Fe={key:0,class:"bi bi-cpu"},Re={key:1,class:"spinner-border spinner-border-sm"},qe={class:"control-row mt-2"},De=["disabled"],ze={key:0,class:"bi bi-search"},Je={key:1,class:"spinner-border spinner-border-sm"},Ke={class:"d-flex align-items-center"},Qe=["innerHTML"],Xe={class:"col-lg-7 col-md-12"},Ye={class:"card tool-card"},Ze={class:"card-header d-flex justify-content-between align-items-center card-header-with-controls"},es={key:0,class:"text-success ms-2 fw-bold"},ss={key:1,class:"text-secondary ms-2"},ts={class:"encode-selector"},as={class:"encode-label"},rs=["data-bs-title"],os={value:"original"},is={value:"base64"},ls={value:"base64url"},ns={value:"hex"},cs={value:"base2"},ds={class:"card-body"},us={key:0,class:"hash-results-container"},ps={class:"hash-results-list"},hs={class:"item-header"},ms={class:"algo-name"},vs={key:0,class:"ms-2"},fs={class:"match-badge matched"},gs={class:"item-hash"},bs={class:"hash-wrapper"},_s=["value"],ws={key:1,class:"empty-results"},ys={class:"text-muted mt-1"},Vs={class:"card tool-card no-footer mt-3"},Hs={class:"card-header"},xs={class:"card-body"},Ts={class:"notice-box"},ks=Q({__name:"PasswordHashVerifierView",setup(Cs){const{t:a}=X(),l=d(""),m=d(""),y=d(!1),h=d(!1),V=d(10),H=d("original"),v=d([]),n=d(null),x=d(!1),b=d(!1),w=d(!1),M=d(null);let S=null;const f=d({bcrypt:!1,scrypt:!1,argon2:!1}),F=A(()=>b.value?"calculating":!l.value&&!m.value||!l.value||!m.value||!h.value&&!w.value?"empty":n.value?"success":"no-match"),R=A(()=>b.value?"spinner-border spinner-border-sm":!l.value||!m.value||!h.value&&!w.value?"bi bi-info-circle text-secondary":n.value?"bi bi-check-circle-fill text-success":"bi bi-x-circle-fill text-danger"),q=A(()=>b.value?a("pages.passwordHashVerifier.status.matching"):!l.value&&!m.value?a("pages.passwordHashVerifier.status.waiting"):l.value?m.value?!h.value&&!w.value?a("pages.passwordHashVerifier.status.waitingManual"):n.value?a("pages.passwordHashVerifier.status.success",{algorithm:n.value}):a("pages.passwordHashVerifier.status.notFound"):a("pages.passwordHashVerifier.status.inputHash"):a("pages.passwordHashVerifier.status.inputPlaintext")),$=t=>new Promise((s,r)=>{if(document.querySelector(`script[src="${t}"]`)){s();return}const c=document.createElement("script");c.src=t,c.onload=()=>s(),c.onerror=()=>r(new Error(`Failed to load script: ${t}`)),document.head.appendChild(c)});Y(async()=>{try{await Promise.all([$(ne).then(()=>f.value.bcrypt=!0),$(ce).then(()=>f.value.scrypt=!0),$(de).then(()=>f.value.argon2=!0)])}catch(t){console.error("Failed to load crypto libraries",t)}});const O=t=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"},D=()=>{y.value&&P()},P=()=>{h.value||(w.value=!1,n.value=null),y.value&&(S&&clearTimeout(S),S=setTimeout(()=>{W()},500))},z=()=>{h.value||(w.value=!1,n.value=null),h.value&&l.value&&v.value.length>0&&T()},U=t=>{if(!t||t.startsWith("Error")||t.startsWith("Library")||H.value==="original")return t;try{const r=new TextEncoder().encode(t);switch(H.value){case"base64":return E(r);case"base64url":return E(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"");case"hex":return J(r);case"base2":return Array.from(r).map(c=>c.toString(2).padStart(8,"0")).join(" ");default:return t}}catch{return t}},E=t=>{let s="";const r=new Uint8Array(t),c=r.byteLength;for(let g=0;g<c;g++)s+=String.fromCharCode(r[g]);return window.btoa(s)},J=t=>Array.from(t).map(s=>s.toString(16).padStart(2,"0")).join(""),W=async()=>{if(!l.value){v.value=[];return}x.value=!0;const t=[];try{if(f.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt){const s=await new Promise(r=>{window.dcodeIO.bcrypt.hash(l.value,V.value,(c,g)=>{r(g)})});t.push({algorithm:"bcrypt",value:s,raw:s,matched:!1})}if(f.value.scrypt&&window.scrypt){const s=new TextEncoder().encode(l.value),r=new TextEncoder().encode("salt"),K=await window.scrypt.scrypt(s,r,16384,8,1,64),G=`$s0$e0801$${window.btoa("salt")}$${window.btoa(String.fromCharCode.apply(null,Array.from(K)))}`;t.push({algorithm:"scrypt",value:G,raw:G,matched:!1})}if(f.value.argon2&&window.argon2)try{const s=await window.argon2.hash({pass:l.value,salt:"somesalt",type:window.argon2.Argon2id,time:2,mem:65536,hashLen:32});t.push({algorithm:"Argon2",value:s.encoded,raw:s.encoded,matched:!1})}catch(s){console.error("Argon2 error",s)}}catch(s){console.error("Generation error",s)}v.value=t,x.value=!1,M.value=new Date().toLocaleTimeString(),h.value&&m.value&&T()},T=async()=>{if(!l.value||!m.value){n.value=null;return}b.value=!0,w.value=!0,n.value=null,v.value.forEach(s=>s.matched=!1);const t=m.value.trim();try{if((t.startsWith("$2")||t.startsWith("$2a")||t.startsWith("$2y")||t.startsWith("$2b"))&&f.value.bcrypt&&window.dcodeIO&&window.dcodeIO.bcrypt&&await new Promise(r=>{window.dcodeIO.bcrypt.compare(l.value,t,(c,g)=>{r(g)})})&&(n.value="bcrypt",I("bcrypt")),!n.value&&t.startsWith("$argon2")&&f.value.argon2&&window.argon2)try{await window.argon2.verify({pass:l.value,encoded:t}),n.value="Argon2",I("Argon2")}catch{}if(!n.value){const s=v.value.find(r=>r.algorithm==="scrypt");s&&s.raw===t&&(n.value="scrypt",I("scrypt"))}}catch(s){console.error("Match error",s)}b.value=!1},I=t=>{const s=v.value.find(r=>r.algorithm===t);s&&(s.matched=!0)};return N(h,t=>{t&&v.value.length>0&&T()}),N(v,async()=>{await oe(),document.querySelectorAll(".hash-value").forEach(s=>O(s))},{deep:!0}),(t,s)=>(p(),u("main",ue,[e("div",pe,[e("div",he,[e("h1",me,i(o(a)("pages.passwordHashVerifier.title")),1),e("p",ve,i(o(a)("pages.passwordHashVerifier.description")),1)]),e("div",fe,[e("nav",ge,[e("ol",be,[e("li",_e,[e("a",we,i(o(a)("breadcrumb.home")),1)]),e("li",ye,[e("a",Ve,i(o(a)("breadcrumb.tools")),1)]),e("li",He,i(o(a)("pages.passwordHashVerifier.title_short")),1)])])])]),e("div",xe,[e("div",Te,[e("div",ke,[e("div",Ce,[s[7]||(s[7]=e("i",{class:"bi bi-sliders"},null,-1)),_(" "+i(o(a)("pages.passwordHashVerifier.settings.title")),1)]),e("div",Me,[e("div",Se,[e("label",$e,i(o(a)("pages.passwordHashVerifier.settings.plaintext"))+":",1),k(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),onInput:P,placeholder:o(a)("pages.passwordHashVerifier.settings.plaintextPlaceholder")},null,40,Ie),[[L,l.value]])]),e("div",Ae,[e("div",Le,[_(i(o(a)("pages.passwordHashVerifier.settings.costLabel"))+" ",1),e("i",{class:"bi bi-question-circle-fill text-muted","data-bs-toggle":"tooltip",title:o(a)("pages.passwordHashVerifier.settings.costTooltip")},null,8,Oe)]),e("div",Pe,[k(e("input",{type:"range",class:"form-range",min:"4",max:"31",step:"1","onUpdate:modelValue":s[1]||(s[1]=r=>V.value=r),onInput:D},null,544),[[L,V.value,void 0,{number:!0}]]),e("span",Ue,i(V.value),1)])]),e("div",Ee,[e("label",We,i(o(a)("pages.passwordHashVerifier.settings.hashToMatch"))+":",1),k(e("textarea",{class:"form-control input-textarea","onUpdate:modelValue":s[2]||(s[2]=r=>m.value=r),onInput:z,placeholder:o(a)("pages.passwordHashVerifier.settings.hashPlaceholder")},null,40,Ge),[[L,m.value]])])]),e("div",Ne,[e("div",je,[C(B,{modelValue:y.value,"onUpdate:modelValue":s[3]||(s[3]=r=>y.value=r),label:o(a)("pages.passwordHashVerifier.settings.autoGenerate"),variant:"custom",layout:"label-first"},null,8,["modelValue","label"]),e("button",{class:"btn btn-ee-base active",disabled:y.value||!l.value||x.value,onClick:W},[x.value?(p(),u("span",Re)):(p(),u("i",Fe)),_(" "+i(o(a)("pages.passwordHashVerifier.settings.manualGenerate")),1)],8,Be)]),e("div",qe,[C(B,{modelValue:h.value,"onUpdate:modelValue":s[4]||(s[4]=r=>h.value=r),label:o(a)("pages.passwordHashVerifier.settings.autoMatch"),variant:"custom",layout:"label-first"},null,8,["modelValue","label"]),e("button",{class:"btn btn-ee-base active",disabled:h.value||b.value,onClick:T},[b.value?(p(),u("span",Je)):(p(),u("i",ze)),_(" "+i(o(a)("pages.passwordHashVerifier.settings.manualMatch")),1)],8,De)]),s[8]||(s[8]=e("div",{class:"board"},null,-1)),e("div",{class:j(["match-result-box",F.value])},[e("div",Ke,[e("i",{class:j(["match-icon",R.value])},null,2),e("p",{class:"match-text",innerHTML:q.value},null,8,Qe)])],2)])])]),e("div",Xe,[e("div",Ye,[e("div",Ze,[e("div",null,[s[10]||(s[10]=e("i",{class:"bi bi-list-check"},null,-1)),_(" "+i(o(a)("pages.passwordHashVerifier.results.title"))+" ",1),C(ee,{name:"fade",mode:"out-in"},{default:Z(()=>[M.value?(p(),u("small",es,[s[9]||(s[9]=e("i",{class:"bi bi-check-circle-fill me-1"},null,-1)),_(" "+i(o(a)("pages.passwordHashVerifier.results.generatedSuccess",{time:M.value})),1)])):(p(),u("small",ss,i(o(a)("pages.passwordHashVerifier.results.notGenerated")),1))]),_:1})]),e("div",ts,[e("label",as,i(o(a)("pages.passwordHashVerifier.results.encoding"))+":",1),e("i",{class:"bi bi-question-circle-fill","data-bs-toggle":"tooltip","data-bs-placement":"top","data-bs-title":o(a)("pages.passwordHashVerifier.results.encodingTooltip")},null,8,rs),k(e("select",{class:"form-select form-select-sm encode-select","onUpdate:modelValue":s[5]||(s[5]=r=>H.value=r)},[e("option",os,i(o(a)("pages.passwordHashVerifier.results.encodingOptions.original")),1),e("option",is,i(o(a)("pages.passwordHashVerifier.results.encodingOptions.base64")),1),e("option",ls,i(o(a)("pages.passwordHashVerifier.results.encodingOptions.base64url")),1),e("option",ns,i(o(a)("pages.passwordHashVerifier.results.encodingOptions.hex")),1),e("option",cs,i(o(a)("pages.passwordHashVerifier.results.encodingOptions.base2")),1)],512),[[se,H.value]])])]),e("div",ds,[v.value.length>0?(p(),u("div",us,[e("div",ps,[(p(!0),u(te,null,ae(v.value,r=>(p(),u("div",{class:"hash-result-item",key:r.algorithm},[e("div",hs,[e("span",ms,i(r.algorithm),1),r.matched?(p(),u("span",vs,[e("span",fs,i(o(a)("pages.passwordHashVerifier.results.matched")),1)])):re("",!0)]),e("div",gs,[e("div",bs,[e("textarea",{class:"hash-value",value:U(r.value),onInput:s[6]||(s[6]=c=>O(c.target)),rows:"1",spellcheck:"false"},null,40,_s),C(le,{text:U(r.value)},null,8,["text"])])])]))),128))])])):(p(),u("div",ws,[s[11]||(s[11]=e("i",{class:"bi bi-fingerprint"},null,-1)),e("p",null,i(o(a)("pages.passwordHashVerifier.results.empty")),1),e("p",ys,i(o(a)("pages.passwordHashVerifier.results.emptyHint")),1)]))])])])]),e("div",Vs,[e("div",Hs,[s[12]||(s[12]=e("i",{class:"bi bi-info-circle"},null,-1)),_(" "+i(o(a)("pages.passwordHashVerifier.notice.title")),1)]),e("div",xs,[e("div",Ts,[e("ul",null,[e("li",null,i(o(a)("pages.passwordHashVerifier.notice.item1")),1),e("li",null,i(o(a)("pages.passwordHashVerifier.notice.item2")),1),e("li",null,i(o(a)("pages.passwordHashVerifier.notice.item3")),1),e("li",null,i(o(a)("pages.passwordHashVerifier.notice.item4")),1)])])])])]))}}),Os=ie(ks,[["__scopeId","data-v-779fd10d"]]);export{Os as default};
