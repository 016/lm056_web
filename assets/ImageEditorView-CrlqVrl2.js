import{d as ve,u as me,r as n,c as pe,k as ge,b as I,e,t as o,f as l,h as U,w as g,p as K,C as be,v as h,n as R,g as P,D as O,B as q,q as fe,o as C,_ as he}from"./index-B816jplU.js";const _e={class:"main-content flex-grow-1",style:{"overflow-x":"scroll !important"}},we={class:"page-header-row"},Ee={class:"page-header-left"},ye={class:"page-title"},ke={class:"page-description"},xe={class:"breadcrumb-custom"},Ie={"aria-label":"breadcrumb"},Ce={class:"breadcrumb mb-0"},Se={class:"breadcrumb-item"},Me={href:"#"},De={class:"breadcrumb-item"},Ve={href:"#"},Ue={class:"breadcrumb-item active","aria-current":"page"},Re={class:"row main-tool-row"},Oe={class:"col-lg-4 col-md-12 mb-3 mb-lg-0"},ze={class:"card tool-card"},je={class:"card-header"},He={class:"card-body"},Te={class:"param-group"},$e={class:"param-label"},Le={class:"upload-hint"},Ne={class:"param-group"},We={class:"param-label"},Ye={value:"custom"},Xe={class:"param-group"},Be={class:"param-label"},Ze={class:"dimension-inputs"},Fe={class:"dimension-group"},Ae={class:"dimension-label"},Ke=["title"],Pe={class:"dimension-group"},qe={class:"dimension-label"},Ge={class:"scale-control"},Je={class:"param-label"},Qe={class:"scale-input-group"},ea=["disabled"],aa=["disabled"],ta={class:"scale-hint"},sa={class:"scale-control"},oa={class:"param-label"},la={class:"scale-input-group"},ia=["disabled"],na=["disabled"],da={class:"scale-hint"},ua={class:"param-group"},ra={class:"param-label"},ca={class:"filename-group"},va=["disabled"],ma={class:"col-lg-8 col-md-12"},pa={class:"card tool-card preview-card"},ga={class:"card-header d-flex align-items-center"},ba={key:0,class:"image-info"},fa={key:0,class:"card-footer preview-footer border-top-0"},ha=["title"],_a=["title"],wa=["title"],Ea=["title"],ya={class:"card tool-card no-footer"},ka={class:"card-header"},xa={class:"card-body"},Ia={class:"notice-box"},Ca=ve({__name:"ImageEditorView",setup(Sa){const{t:s}=me(),r=n(null),S=n(0),M=n(0),v=n(528),m=n(704),y=n("moonlight"),b=n(!0),D=n(528/704),u=n(100),_=n(0),w=n(0),k=n("my-edited-image"),E=n("png"),V=n(!1),x=n(!1),j=n(0),H=n(0),T=n(0),$=n(0),c=n(100),L=n(null),z=n(null),G={moonlight:{width:528,height:704},default:{width:200,height:200},"720p":{width:1280,height:720},"1080p":{width:1920,height:1080},"2k":{width:2560,height:1440},"4k":{width:3840,height:2160}},N=pe(()=>({transform:`scale(${c.value/100})`,transformOrigin:"top left",transition:x.value?"none":"transform 0.2s ease"})),W=(i="dpit_")=>{const a=Math.floor(Math.random()*1e4),t=String(a).padStart(4,"0");return`${i}${t}`},J=i=>{var d;const t=(d=i.target.files)==null?void 0:d[0];t&&t.type.startsWith("image/")&&Y(t)},Q=i=>{V.value=!0},ee=i=>{V.value=!1},ae=i=>{var t;V.value=!1;const a=(t=i.dataTransfer)==null?void 0:t.files[0];a&&a.type.startsWith("image/")&&Y(a)},Y=i=>{const a=new FileReader;a.onload=t=>{var f;const d=new Image;d.onload=()=>{r.value=d,S.value=d.width,M.value=d.height,_.value=0,w.value=0,u.value=100,k.value=W(),p(),fe(()=>{A()})},d.src=(f=t.target)==null?void 0:f.result},a.readAsDataURL(i)},te=()=>{if(y.value==="custom")return;const i=G[y.value];i&&(v.value=i.width,m.value=i.height,b.value&&(D.value=v.value/m.value),p())},X=i=>{y.value="custom",b.value&&(i==="width"?m.value=Math.round(v.value/D.value):v.value=Math.round(m.value*D.value)),p()},se=()=>{b.value=!b.value,b.value&&(D.value=v.value/m.value)},B=()=>{p()},Z=()=>{c.value<10&&(c.value=10),c.value>200&&(c.value=200)},p=()=>{const i=z.value;if(!i)return;i.width=v.value,i.height=m.value;const a=i.getContext("2d");if(a&&(a.fillStyle="#ffffff",a.fillRect(0,0,v.value,m.value),r.value)){const t=S.value*(u.value/100),d=M.value*(u.value/100),f=(v.value-t)/2+_.value,ce=(m.value-d)/2+w.value;a.drawImage(r.value,f,ce,t,d)}},oe=i=>{r.value&&(x.value=!0,j.value=i.clientX,H.value=i.clientY,T.value=_.value,$.value=w.value)},le=i=>{if(!x.value)return;const a=i.clientX-j.value,t=i.clientY-H.value,d=c.value/100;_.value=T.value+a/d,w.value=$.value+t/d,p()},F=()=>{x.value=!1},ie=i=>{if(!r.value)return;const a=i.deltaY>0?-5:5;u.value=Math.max(1,Math.min(500,u.value+a)),p()},ne=()=>{u.value=Math.min(500,u.value+10),p()},de=()=>{u.value=Math.max(1,u.value-10),p()},ue=()=>{_.value=0,w.value=0,u.value=100,c.value=100,p()},A=()=>{if(!r.value)return;const i=v.value/S.value,a=m.value/M.value,t=Math.max(i,a);u.value=Math.round(t*100),_.value=0,w.value=0,c.value=100,p()},re=()=>{if(!r.value)return;const i=z.value;if(!i)return;const a=document.createElement("a");let t="image/png";E.value==="jpg"||E.value==="jpeg"?t="image/jpeg":E.value==="webp"&&(t="image/webp"),i.toBlob(d=>{if(d){const f=URL.createObjectURL(d);a.href=f,a.download=`${k.value}.${E.value}`,a.click(),URL.revokeObjectURL(f)}},t)};return ge(()=>{p(),k.value=W()}),(i,a)=>(C(),I("main",_e,[e("div",we,[e("div",Ee,[e("h1",ye,o(l(s)("pages.imageEditor.title")),1),e("p",ke,o(l(s)("pages.imageEditor.description")),1)]),e("div",xe,[e("nav",Ie,[e("ol",Ce,[e("li",Se,[e("a",Me,o(l(s)("breadcrumb.home")),1)]),e("li",De,[e("a",Ve,o(l(s)("breadcrumb.tools")),1)]),e("li",Ue,o(l(s)("pages.imageEditor.title_short")),1)])])])]),e("div",Re,[e("div",Oe,[e("div",ze,[e("div",je,[a[12]||(a[12]=e("i",{class:"bi bi-sliders"},null,-1)),U(" "+o(l(s)("pages.imageEditor.settings")),1)]),e("div",He,[e("div",Te,[e("label",$e,o(l(s)("pages.imageEditor.uploadImage")),1),e("input",{type:"file",ref_key:"fileInput",ref:L,onChange:J,accept:"image/*",style:{display:"none"}},null,544),e("div",{class:"upload-btn",onClick:a[0]||(a[0]=t=>{var d;return(d=L.value)==null?void 0:d.click()})},[a[13]||(a[13]=e("i",{class:"bi bi-cloud-upload"},null,-1)),e("div",null,o(l(s)("pages.imageEditor.clickToSelect")),1),e("div",Le,o(l(s)("pages.imageEditor.dragHint")),1)])]),e("div",Ne,[e("label",We,o(l(s)("pages.imageEditor.presetSize")),1),g(e("select",{class:"form-select preset-select","onUpdate:modelValue":a[1]||(a[1]=t=>y.value=t),onChange:te},[a[14]||(a[14]=be('<option value="moonlight" data-v-e95d9e70>Moonlight - 528x704</option><option value="default" data-v-e95d9e70>Default - 200x200</option><option value="720p" data-v-e95d9e70>720p - 1280x720</option><option value="1080p" data-v-e95d9e70>1080p - 1920x1080</option><option value="2k" data-v-e95d9e70>2K - 2560x1440</option><option value="4k" data-v-e95d9e70>4K - 3840x2160</option>',6)),e("option",Ye,o(l(s)("pages.imageEditor.custom")),1)],544),[[K,y.value]])]),e("div",Xe,[e("label",Be,o(l(s)("pages.imageEditor.canvasSize")),1),e("div",Ze,[e("div",Fe,[e("span",Ae,o(l(s)("pages.imageEditor.width"))+":",1),g(e("input",{type:"number",class:"form-control dimension-input","onUpdate:modelValue":a[2]||(a[2]=t=>v.value=t),onInput:a[3]||(a[3]=t=>X("width")),min:"1"},null,544),[[h,v.value,void 0,{number:!0}]]),a[15]||(a[15]=e("span",{class:"dimension-unit"},"px",-1))]),e("button",{class:R(["lock-btn",{locked:b.value}]),onClick:se,title:b.value?l(s)("pages.imageEditor.unlockRatio"):l(s)("pages.imageEditor.lockRatio")},[e("i",{class:R(b.value?"bi bi-lock-fill":"bi bi-unlock")},null,2)],10,Ke),e("div",Pe,[e("span",qe,o(l(s)("pages.imageEditor.height"))+":",1),g(e("input",{type:"number",class:"form-control dimension-input","onUpdate:modelValue":a[4]||(a[4]=t=>m.value=t),onInput:a[5]||(a[5]=t=>X("height")),min:"1"},null,544),[[h,m.value,void 0,{number:!0}]]),a[16]||(a[16]=e("span",{class:"dimension-unit"},"px",-1))])])]),e("div",Ge,[e("label",Je,o(l(s)("pages.imageEditor.imageScale")),1),e("div",Qe,[g(e("input",{type:"number",class:"form-control scale-input","onUpdate:modelValue":a[6]||(a[6]=t=>u.value=t),onInput:B,min:"1",max:"500",disabled:!r.value},null,40,ea),[[h,u.value,void 0,{number:!0}]]),a[17]||(a[17]=e("span",{class:"dimension-unit"},"%",-1)),g(e("input",{type:"range",class:"form-range scale-slider","onUpdate:modelValue":a[7]||(a[7]=t=>u.value=t),onInput:B,min:"1",max:"500",disabled:!r.value},null,40,aa),[[h,u.value,void 0,{number:!0}]])]),e("div",ta,o(l(s)("pages.imageEditor.imageScaleHint")),1)]),e("div",sa,[e("label",oa,o(l(s)("pages.imageEditor.canvasZoom")),1),e("div",la,[g(e("input",{type:"number",class:"form-control scale-input","onUpdate:modelValue":a[8]||(a[8]=t=>c.value=t),onInput:Z,min:"10",max:"200",disabled:!r.value},null,40,ia),[[h,c.value,void 0,{number:!0}]]),a[18]||(a[18]=e("span",{class:"dimension-unit"},"%",-1)),g(e("input",{type:"range",class:"form-range scale-slider","onUpdate:modelValue":a[9]||(a[9]=t=>c.value=t),onInput:Z,min:"10",max:"200",disabled:!r.value},null,40,na),[[h,c.value,void 0,{number:!0}]])]),e("div",da,o(l(s)("pages.imageEditor.canvasZoomHint")),1)]),e("div",ua,[e("label",ra,o(l(s)("pages.imageEditor.saveName")),1),e("div",ca,[g(e("input",{type:"text",class:"form-control filename-input","onUpdate:modelValue":a[10]||(a[10]=t=>k.value=t),placeholder:"my-edited-image"},null,512),[[h,k.value]]),g(e("select",{class:"form-select extension-select","onUpdate:modelValue":a[11]||(a[11]=t=>E.value=t)},[...a[19]||(a[19]=[e("option",{value:"png"},".png",-1),e("option",{value:"jpg"},".jpg",-1),e("option",{value:"jpeg"},".jpeg",-1),e("option",{value:"webp"},".webp",-1)])],512),[[K,E.value]])])]),e("button",{class:"btn btn-ee-base active w-100",onClick:re,disabled:!r.value},[a[20]||(a[20]=e("i",{class:"bi bi-download"},null,-1)),U(" "+o(l(s)("pages.imageEditor.download")),1)],8,va)])])]),e("div",ma,[e("div",pa,[e("div",ga,[a[21]||(a[21]=e("i",{class:"bi bi-image"},null,-1)),U(" "+o(l(s)("pages.imageEditor.preview"))+" ",1),r.value?(C(),I("div",ba,o(l(s)("pages.imageEditor.original"))+": "+o(S.value)+"×"+o(M.value)+" | "+o(l(s)("pages.imageEditor.canvas"))+": "+o(v.value)+"×"+o(m.value)+" | "+o(l(s)("pages.imageEditor.imageScale"))+": "+o(u.value)+"% | "+o(l(s)("pages.imageEditor.canvasZoom"))+": "+o(c.value)+"% ",1)):P("",!0)]),r.value?(C(),I("div",fa,[e("button",{class:"toolbar-btn",onClick:ne,title:l(s)("pages.imageEditor.zoomIn")},[...a[22]||(a[22]=[e("i",{class:"bi bi-zoom-in"},null,-1)])],8,ha),e("button",{class:"toolbar-btn",onClick:de,title:l(s)("pages.imageEditor.zoomOut")},[...a[23]||(a[23]=[e("i",{class:"bi bi-zoom-out"},null,-1)])],8,_a),e("button",{class:"toolbar-btn",onClick:ue,title:l(s)("pages.imageEditor.reset")},[...a[24]||(a[24]=[e("i",{class:"bi bi-arrow-clockwise"},null,-1)])],8,wa),a[26]||(a[26]=e("div",{class:"toolbar-divider"},null,-1)),e("button",{class:"toolbar-btn",onClick:A,title:l(s)("pages.imageEditor.fitToCanvas")},[...a[25]||(a[25]=[e("i",{class:"bi bi-aspect-ratio"},null,-1)])],8,Ea)])):P("",!0)]),r.value?(C(),I("div",{key:1,class:"canvas-container",style:q(N.value)},[e("canvas",{ref_key:"previewCanvas",ref:z,id:"previewCanvas",class:R({dragging:x.value}),style:q(N.value),onMousedown:oe,onMousemove:le,onMouseup:F,onMouseleave:F,onWheel:O(ie,["prevent"])},null,38)],4)):(C(),I("div",{key:0,class:R(["empty-preview",{"drag-over":V.value}]),onDragover:O(Q,["prevent"]),onDragleave:O(ee,["prevent"]),onDrop:O(ae,["prevent"])},[a[27]||(a[27]=e("i",{class:"bi bi-image"},null,-1)),e("p",null,o(l(s)("pages.imageEditor.emptyHint1")),1),e("p",null,o(l(s)("pages.imageEditor.emptyHint2")),1)],34))])]),e("div",ya,[e("div",ka,[a[28]||(a[28]=e("i",{class:"bi bi-info-circle"},null,-1)),U(" "+o(l(s)("pages.imageEditor.notice.title")),1)]),e("div",xa,[e("div",Ia,[e("ul",null,[e("li",null,o(l(s)("pages.imageEditor.notice.item1")),1),e("li",null,o(l(s)("pages.imageEditor.notice.item2")),1),e("li",null,o(l(s)("pages.imageEditor.notice.item3")),1),e("li",null,o(l(s)("pages.imageEditor.notice.item4")),1)])])])])]))}}),Da=he(Ca,[["__scopeId","data-v-e95d9e70"]]);export{Da as default};
