import{d as ae,u as le,r as o,c as ie,i as oe,a as N,b as e,t as n,e as i,n as u,g as I,w as F,v as U,F as ne,h as ce,A as re,p as fe,o as V,_ as ue}from"./index-4vlBv0sC.js";const de={class:"main-content flex-grow-1"},ve={class:"page-header-row"},pe={class:"page-header-left"},ge={class:"page-title"},he={class:"page-description"},me={class:"breadcrumb-custom"},be={"aria-label":"breadcrumb"},_e={class:"breadcrumb mb-0"},xe={class:"breadcrumb-item"},De={href:"#"},Te={class:"breadcrumb-item"},ye={href:"#"},Ce={class:"breadcrumb-item active","aria-current":"page"},we={class:"card tool-card"},ke={class:"card-body py-3"},He={class:"action-row"},Le={class:"status-text"},Me={class:"action-buttons"},Se={class:"diff-panel"},Oe={class:"diff-header"},Ie={class:"diff-header-title"},$e={class:"height-controls"},Ae={class:"diff-editor"},Ne={class:"diff-textarea-wrapper"},Ve=["placeholder"],Ee=["innerHTML"],Be={class:"diff-panel"},Re={class:"diff-header"},je={class:"diff-header-title"},qe={class:"diff-editor"},ze={class:"diff-textarea-wrapper"},Fe=["placeholder"],Ue=["innerHTML"],Ke={class:"card tool-card no-footer mt-4"},We={class:"card-header"},Ye={class:"card-body"},Ge={class:"notice-box"},Je=ae({__name:"TextDiffView",setup(Pe){const{t:a}=le(),x=o(null),g=o(""),h=o(""),D=o(""),T=o(""),y=o([]),p=o(!0),C=o(""),$=o(void 0),E=o("status-idle"),B=o("bi bi-circle"),m=o("medium"),b=o(!1),K=ie(()=>C.value?$.value!==void 0?a(C.value,{count:$.value}):a(C.value):""),r=o(null),w=o(null),k=o(null),H=o(null),L=o(null),M=o(null),W=o(null),f=(s,t,l,c)=>{E.value=`status-${s}`,B.value=l,C.value=t,$.value=c},Y=s=>s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),A=()=>{if(!x.value)return;if(!g.value&&!h.value){f("idle","pages.textDiff.status.ready","bi bi-circle"),D.value="",T.value="",y.value=[];return}const s=x.value.diffWords(g.value,h.value);let t="",l="",c=0;s.forEach(d=>{const v=Y(d.value);d.added?(l+=`<span class="diff-added">${v}</span>`,c++):d.removed?(t+=`<span class="diff-removed">${v}</span>`,c++):(t+=v,l+=v)}),D.value=t,T.value=l,c>0?f("different","pages.textDiff.status.different","bi bi-exclamation-triangle-fill",c):f("same","pages.textDiff.status.same","bi bi-check-circle-fill"),fe(()=>{G()})},G=()=>{var v,q;if(!r.value)return;const s=[],t=r.value.scrollHeight,l=((v=k.value)==null?void 0:v.querySelectorAll(".diff-removed"))||[],c=((q=H.value)==null?void 0:q.querySelectorAll(".diff-added"))||[],d=(_,ee)=>{const z=_.offsetTop,te=_.offsetHeight,se=z/t*100;s.push({type:ee,position:se,top:z,height:te})};l.forEach(_=>d(_,"removed")),c.forEach(_=>d(_,"added")),y.value=s},R=()=>{p.value&&(f("comparing","pages.textDiff.status.comparing","bi bi-arrow-repeat"),setTimeout(()=>{A()},10)),S()},S=()=>{const s=(t,l)=>{if(!t||!l)return;const c=t.value.split(`
`).length;l.innerHTML=Array(c).fill(0).map((d,v)=>`<div>${v+1}</div>`).join("")};s(r.value,L.value),s(w.value,M.value)},J=()=>{p.value=!p.value,p.value?(f("autoCompareOn","pages.textDiff.status.autoCompareOn","bi bi-toggle-on"),A()):f("autoCompareOff","pages.textDiff.status.autoCompareOff","bi bi-toggle-off")},P=()=>{confirm(a("pages.textDiff.actions.clearConfirm"))&&(g.value="",h.value="",D.value="",T.value="",y.value=[],f("cleared","pages.textDiff.status.cleared","bi bi-circle"),S())},Q=()=>{const s=g.value;g.value=h.value,h.value=s,f("swapped","pages.textDiff.status.swapped","bi bi-arrow-left-right"),p.value&&A(),S()},O=s=>{m.value=s},j=s=>{if(b.value)return;b.value=!0;const t=s.target;w.value&&(w.value.scrollTop=t.scrollTop),k.value&&(k.value.scrollTop=t.scrollTop),L.value&&(L.value.scrollTop=t.scrollTop),b.value=!1},X=s=>{if(b.value)return;b.value=!0;const t=s.target;r.value&&(r.value.scrollTop=t.scrollTop),H.value&&(H.value.scrollTop=t.scrollTop),M.value&&(M.value.scrollTop=t.scrollTop),b.value=!1},Z=s=>{if(!r.value)return;const t=s.currentTarget.getBoundingClientRect(),c=(s.clientY-t.top)/t.height,d=r.value.scrollHeight*c;r.value.scrollTop=d,j({target:r.value})};return oe(()=>{if(window.Diff)x.value=window.Diff,f("idle","pages.textDiff.status.ready","bi bi-circle");else{const s=document.createElement("script");s.src="https://cdn.jsdelivr.net/npm/diff@5.1.0/dist/diff.min.js",s.onload=()=>{x.value=window.Diff,f("idle","pages.textDiff.status.ready","bi bi-circle")},document.head.appendChild(s)}S()}),(s,t)=>(V(),N("main",de,[e("div",ve,[e("div",pe,[e("h1",ge,n(i(a)("pages.textDiff.title")),1),e("p",he,n(i(a)("pages.textDiff.description")),1)]),e("div",me,[e("nav",be,[e("ol",_e,[e("li",xe,[e("a",De,n(i(a)("nav.home")),1)]),e("li",Te,[e("a",ye,n(i(a)("nav.tools")),1)]),e("li",Ce,n(i(a)("pages.textDiff.title_short")),1)])])])]),e("div",we,[e("div",ke,[e("div",He,[e("div",{class:u(["status-bar",E.value])},[e("i",{class:u(B.value)},null,2),e("span",Le,n(K.value),1)],2),e("div",Me,[e("button",{class:u(["btn btn-action btn-compare",{inactive:!p.value}]),onClick:J},[e("i",{class:u(p.value?"bi bi-toggle-on":"bi bi-toggle-off")},null,2),I(" "+n(p.value?i(a)("pages.textDiff.actions.autoCompareOn"):i(a)("pages.textDiff.actions.autoCompareOff")),1)],2),e("button",{class:"btn btn-action btn-clear",onClick:P},[t[6]||(t[6]=e("i",{class:"bi bi-trash"},null,-1)),I(" "+n(i(a)("pages.textDiff.actions.clear")),1)]),e("button",{class:"btn btn-action btn-swap",onClick:Q},[t[7]||(t[7]=e("i",{class:"bi bi-arrow-left-right"},null,-1)),I(" "+n(i(a)("pages.textDiff.actions.swap")),1)])])])])]),e("div",{class:u(["diff-container","height-"+m.value])},[e("div",Se,[e("div",Oe,[e("span",Ie,n(i(a)("pages.textDiff.panels.original")),1),e("div",$e,[e("button",{class:u(["btn-height",{active:m.value==="small"}]),onClick:t[0]||(t[0]=l=>O("small"))},n(i(a)("pages.textDiff.height.small")),3),e("button",{class:u(["btn-height",{active:m.value==="medium"}]),onClick:t[1]||(t[1]=l=>O("medium"))},n(i(a)("pages.textDiff.height.medium")),3),e("button",{class:u(["btn-height",{active:m.value==="large"}]),onClick:t[2]||(t[2]=l=>O("large"))},n(i(a)("pages.textDiff.height.large")),3),e("button",{class:u(["btn-height",{active:m.value==="ex-large"}]),onClick:t[3]||(t[3]=l=>O("ex-large"))},n(i(a)("pages.textDiff.height.exLarge")),3)])]),e("div",Ae,[e("div",{class:"line-numbers",ref_key:"leftLineNumbers",ref:L},null,512),e("div",Ne,[F(e("textarea",{class:"diff-textarea","onUpdate:modelValue":t[4]||(t[4]=l=>g.value=l),onInput:R,onScroll:j,ref_key:"leftTextarea",ref:r,placeholder:i(a)("pages.textDiff.placeholders.original")},null,40,Ve),[[U,g.value]]),e("div",{class:"diff-overlay",ref_key:"leftOverlay",ref:k},[e("div",{class:"diff-overlay-content",innerHTML:D.value},null,8,Ee)],512)]),e("div",{class:"diff-map",onClick:Z,ref_key:"diffMapRef",ref:W},[(V(!0),N(ne,null,ce(y.value,(l,c)=>(V(),N("div",{key:c,class:u(["diff-map-item",l.type]),style:re({top:l.position+"%"})},null,6))),128))],512)])]),e("div",Be,[e("div",Re,[e("span",je,n(i(a)("pages.textDiff.panels.target")),1)]),e("div",qe,[e("div",{class:"line-numbers",ref_key:"rightLineNumbers",ref:M},null,512),e("div",ze,[F(e("textarea",{class:"diff-textarea","onUpdate:modelValue":t[5]||(t[5]=l=>h.value=l),onInput:R,onScroll:X,ref_key:"rightTextarea",ref:w,placeholder:i(a)("pages.textDiff.placeholders.target")},null,40,Fe),[[U,h.value]]),e("div",{class:"diff-overlay",ref_key:"rightOverlay",ref:H},[e("div",{class:"diff-overlay-content",innerHTML:T.value},null,8,Ue)],512)])])])],2),e("div",Ke,[e("div",We,[t[8]||(t[8]=e("i",{class:"bi bi-info-circle"},null,-1)),I(" "+n(i(a)("pages.textDiff.notice.title")),1)]),e("div",Ye,[e("div",Ge,[e("ul",null,[e("li",null,n(i(a)("pages.textDiff.notice.item1")),1),e("li",null,n(i(a)("pages.textDiff.notice.item2")),1),e("li",null,n(i(a)("pages.textDiff.notice.item3")),1),e("li",null,n(i(a)("pages.textDiff.notice.item4")),1)])])])])]))}}),Xe=ue(Je,[["__scopeId","data-v-8ccc71ef"]]);export{Xe as default};
